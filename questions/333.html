
<style>
    * {
        box-sizing: border-box !important;
    }

    body {
        font-family: 'Inter', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;
        line-height: 1.9 !important;
        color: #1f1f1f !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 8px 16px 16px 16px !important;
        background: #ffffff !important;
        font-size: 16.5px !important;
    }

    p {
        margin-bottom: 20px !important;
        font-size: 16.5px !important;
        line-height: 1.95 !important;
        color: #1f1f1f !important;
        font-weight: 400 !important;
    }

    strong, b {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        background: rgba(26, 115, 232, 0.08) !important;
        padding: 2px 6px !important;
        border-radius: 8px !important;
    }

    /* Details/Summary (collapsible sections) */
    details {
        background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%) !important;
        border-radius: 8px !important;
        padding: 24px 28px !important;
        margin: 24px 0 !important;
        border: none;
        box-shadow: none !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    }

    details:hover {
        border-color: #1a73e8 !important;
        box-shadow: none !important;
        transform: translateY(-2px) !important;
    }

    details[open] {
        background: #ffffff !important;
        border-color: #1a73e8 !important;
        box-shadow: none !important;
    }

    summary {
        cursor: pointer !important;
        font-weight: 800 !important;
        color: #ffffff !important;
        font-size: 20px !important;
        padding: 16px 24px !important;
        border-radius: 8px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        display: flex !important;
        align-items: center !important;
        user-select: none !important;
        box-shadow: none !important;
        letter-spacing: 0.5px !important;
    }

    summary:hover {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        transform: translateX(6px) scale(1.02) !important;
        box-shadow: none !important;
    }

    summary:active {
        transform: translateX(4px) scale(0.99) !important;
    }

    summary::marker {
        color: rgba(255, 255, 255, 0.9) !important;
        font-size: 1.3em !important;
    }

    summary strong {
        background: rgba(255, 255, 255, 0.2) !important;
        color: #ffffff !important;
        padding: 4px 12px !important;
        border-radius: 8px !important;
        margin-left: 8px !important;
        font-size: 19px !important;
        letter-spacing: 1px !important;
    }

    /* Tables - Premium Design */
    table {
        width: 100% !important;
        border-collapse: separate !important;
        border-spacing: 0 !important;
        margin: 28px 0 !important;
        border-radius: 8px !important;
        overflow: hidden !important;
        box-shadow: none !important;
        border: none !important;
        background: #ffffff !important;
    }

    table.simple-table {
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%) !important;
    }

    table tr {
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1) !important;
        position: relative !important;
    }

    table tr:nth-child(odd) {
        background: rgba(248, 249, 250, 0.5) !important;
    }

    table tr:nth-child(even) {
        background: rgba(255, 255, 255, 0.8) !important;
    }

    table tr:hover {
        background: linear-gradient(90deg, #e8f0fe 0%, #f1f8ff 100%) !important;
        transform: translateX(4px) scale(1.01) !important;
        box-shadow: none !important;
        z-index: 1 !important;
    }

    table td {
        padding: 18px 24px !important;
        border-bottom: 1px solid rgba(232, 234, 237, 0.6) !important;
        font-size: 16.5px !important;
        line-height: 1.7 !important;
        color: #1f1f1f !important;
        vertical-align: middle !important;
    }

    table tr:last-child td {
        border-bottom: none !important;
    }

    /* First column (A, B, C, D, E) */
    table td:first-child {
        font-weight: 800 !important;
        color: #ffffff !important;
        width: 52px !important;
        text-align: center !important;
        font-size: 18px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        border-right: 3px solid #1557b0 !important;
        position: relative !important;
        letter-spacing: 0.5px !important;
    }

    table tr:hover td:first-child {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        box-shadow: none !important;
    }

    /* Second column (content) */
    table td:nth-child(2) {
        font-weight: 500 !important;
        padding-left: 28px !important;
    }

    /* Third column (empty - hide it) */
    table td:last-child:empty {
        display: none !important;
    }

    /* Lists */
    ul, ol {
        margin: 16px 0 !important;
        padding-left: 32px !important;
    }

    li {
        margin: 10px 0 !important;
        line-height: 1.8 !important;
        color: #1f1f1f !important;
    }

    ul.bulleted-list li {
        position: relative !important;
        padding-left: 8px !important;
    }

    ul.toggle {
        list-style: none !important;
        padding-left: 0 !important;
    }

    /* Links */
    a {
        color: #1a73e8 !important;
        text-decoration: none !important;
        font-weight: 600 !important;
        border-bottom: 2px solid transparent !important;
        transition: all 0.2s !important;
    }

    a:hover {
        border-bottom-color: #1a73e8 !important;
        background: rgba(26,115,232,0.08) !important;
        padding: 2px 4px !important;
        border-radius: 8px !important;
    }

    /* Images & Media */
    img, video {
        max-width: none !important;
        height: auto !important;
        border-radius: 8px !important;
        box-shadow: none !important;
        margin: 24px 0 !important;
        display: block !important;
        border: none !important;
    }

    img:hover, video:hover {
        box-shadow: none !important;
        border-color: #1a73e8 !important;
    }

    /* Code blocks (if any) */
    code {
        background: #f1f3f4 !important;
        padding: 2px 8px !important;
        border-radius: 8px !important;
        font-family: 'Courier New', monospace !important;
        font-size: 14px !important;
        color: #d93025 !important;
    }

    pre {
        background: #f8f9fa !important;
        padding: 8px 16px 16px 16px !important;
        border-radius: 8px !important;
        overflow-x: auto !important;
        border-left: 4px solid #1a73e8 !important;
    }

    /* Headings */
    h1, h2, h3, h4, h5, h6 {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        margin-top: 24px !important;
        margin-bottom: 16px !important;
        line-height: 1.4 !important;
    }

    h1 { font-size: 32px !important; }
    h2 { font-size: 26px !important; }
    h3 { font-size: 22px !important; }
    h4 { font-size: 19px !important; }

    /* Blockquotes */
    blockquote {
        border-left: 4px solid #1a73e8 !important;
        padding-left: 20px !important;
        margin: 20px 0 !important;
        font-style: italic !important;
        color: #5f6368 !important;
        background: #f8f9fa !important;
        padding: 16px 20px !important;
        border-radius: 8px !important;
    }

    /* Horizontal Rule */
    hr {
        border: none !important;
        height: 2px !important;
        background: linear-gradient(to right, transparent, #1a73e8, transparent) !important;
        margin: 32px 0 !important;
    }

    /* Selection */
    ::selection {
        background: #e8f0fe !important;
        color: #1a73e8 !important;
    }

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }

</style>




<details open>
<summary><strong>333</strong><button class="bionic-reading-btn" onclick="toggleBionicReading(event)" title="Toggle Bionic Reading (Ctrl+B)"><span id="bionicIcon">üëÅÔ∏è</span></button><button class="highlighter-btn" onclick="toggleHighlighter(event)" title="Toggle Highlighter (Ctrl+H)"><span id="highlighterIcon">üñäÔ∏è</span></button></summary>
<p class="" id="9b52bc19-04e8-4800-9517-7a03142b612f">A 28-year-old nulliparous
                                        woman comes to the clinic for an infertility evaluation.  The patient has had
                                        unprotected intercourse with her husband for the past 12 months without
                                        conceiving and often experiences pain with deep vaginal penetration.  Menarche
                                        was at age 11, and her menstrual period occurs every 26 days and lasts 5-7
                                        days.  Menstrual cycles are accompanied by moderate to severe lower abdominal
                                        pain.  Pelvic examination shows a normal-sized, retroverted uterus.  The
                                        posterior vaginal fornix is tender to palpation.  Which of the following
                                        pathologic findings are most likely to be seen in this patient?</p>
<table class="simple-table" id="fa9275d9-56f9-4857-81f5-8f0e4d62d7dc">
<tbody>
<tr id="10d50ce0-b3b8-4335-b212-6d8af5a60127">
<td class="" id="SCfV">A.</td>
<td class="" id="lV_Z">Ectopic endometrial tissue</td>
<td class="" id="w{iI"></td>
</tr>
<tr id="db94e923-8af8-42cb-8e0d-7e72a682dd6b">
<td class="" id="SCfV">B.</td>
<td class="" id="lV_Z">Glycogen-deficient vaginal epithelium</td>
<td class="" id="w{iI"></td>
</tr>
<tr id="1dea55d0-a64e-42bd-b0a6-9ae2186f45b5">
<td class="" id="SCfV">C.</td>
<td class="" id="lV_Z">Increased endometrial gland/stroma ratio</td>
<td class="" id="w{iI"></td>
</tr>
<tr id="95dbbd92-1864-42f7-97c8-48ee795e80ef">
<td class="" id="SCfV">D.</td>
<td class="" id="lV_Z">Multiple ovarian cysts with cortical fibrosis
                                                </td>
<td class="" id="w{iI"></td>
</tr>
<tr id="0683cdf9-74ed-4760-89ac-868f25094328">
<td class="" id="SCfV">E.</td>
<td class="" id="lV_Z">Proliferation of endometrial glands within the
                                                    myometrium</td>
<td class="" id="w{iI"></td>
</tr>
</tbody>
</table>
<ul class="toggle" id="171379e9-b6ce-413b-a1b4-5272f522f2ef">
<li>
<details>
<summary>Submit</summary>
<table class="simple-table" id="e26e3602-ea4c-46ff-b5ff-deb189bf3bd7">
<tbody>
<tr id="8a862ec4-5238-449b-93a2-d52459681d92">
<td class="" id="vGoj">A.</td>
<td class="" id="=:fU">Ectopic endometrial tissue (65%)</td>
<td class="" id="k{eW"></td>
</tr>
<tr id="4083a55d-146f-4f7c-b419-dc074dd7675e">
<td class="" id="vGoj">B.</td>
<td class="" id="=:fU">Glycogen-deficient vaginal epithelium
                                                                (5%)</td>
<td class="" id="k{eW"></td>
</tr>
<tr id="696c5e75-4a2a-46e9-8c46-2ea1c73d3fdc">
<td class="" id="vGoj">C.</td>
<td class="" id="=:fU">Increased endometrial gland/stroma
                                                                ratio (8%)</td>
<td class="" id="k{eW"></td>
</tr>
<tr id="61d4d196-16ec-4100-9d91-3d85485b13b3">
<td class="" id="vGoj">D.</td>
<td class="" id="=:fU">Multiple ovarian cysts with cortical
                                                                fibrosis (4%)</td>
<td class="" id="k{eW"></td>
</tr>
<tr id="7fa7f1a2-bf7d-4065-a77c-fe0c7b668f2a">
<td class="" id="vGoj">E.</td>
<td class="" id="=:fU">Proliferation of endometrial glands
                                                                within the myometrium (15%)</td>
<td class="" id="k{eW"></td>
</tr>
</tbody>
</table>
<p class="" id="34f8b56e-e5d7-4433-ba35-0ab26d89e564">Omitted</p>
<p class="" id="16ade04f-787f-4fdc-8ae0-b140a83224a5">Correct answer A
                                                </p>
<p class="" id="5f0d8fbc-c958-42b1-9576-5f1bbf261446">65%Answered
                                                    correctly</p>
<p class="" id="3adc3716-7a0c-4bea-9c8f-b07e2b24285d">20 secsTime Spent
                                                </p>
<p class="" id="5ee3ca35-448d-4062-b595-03e1194a4daf">2024Version</p>
<ul class="bulleted-list" id="45086a13-8227-4ea8-ada6-f29e8c8fd6ea">
<li style="list-style-type:disc">Explanation</li>
</ul>
<ul class="bulleted-list" id="ce4bbaf6-8fc9-47ab-9a74-f6c69773152b">
<li style="list-style-type:disc"></li>
</ul>
<table class="simple-table" id="e779b496-e71a-4837-addc-d84a4e3a1225">
<tbody>
<tr id="d550844c-4026-4f03-a3b7-3f26a1e8abb9">
<td class="" id=";|xh">Endometriosis</td>
<td class="" id="l^A]"></td>
</tr>
<tr id="041a04b8-ce4b-407f-a285-dd286816cc77">
<td class="" id=";|xh">Etiology</td>
<td class="" id="l^A]">‚Ä¢ Extrauterine implantation of
                                                                ectopic endometrial glands &amp; stroma</td>
</tr>
<tr id="e71abe8d-464f-46b6-b126-9408d9963263">
<td class="" id=";|xh">Clinical features</td>
<td class="" id="l^A]">‚Ä¢ Dysmenorrhea<br/>‚Ä¢
                                                                Dyspareunia<br/>‚Ä¢ Adnexal mass (endometrioma)<br/>‚Ä¢
                                                                Immobile uterus<br/></td>
</tr>
<tr id="72ed4fbd-5366-4ebf-971d-96a32111d860">
<td class="" id=";|xh">Diagnosis</td>
<td class="" id="l^A]">‚Ä¢ Direct visualization, surgical
                                                                biopsy</td>
</tr>
<tr id="7cf34993-e862-459a-81a1-5fe7e8fdc317">
<td class="" id=";|xh">Complications</td>
<td class="" id="l^A]">‚Ä¢ Chronic pelvic pain<br/>‚Ä¢
                                                                Infertility<br/></td>
</tr>
</tbody>
</table>
<p class="" id="fc98caae-0a28-4d7b-84c9-70432058e7f6">This patient with
                                                    dysmenorrhea and dyspareunia likely has endometriosis, the presence
                                                    of ectopic endometrial glands and stroma in an extrauterine location
                                                    (eg, peritoneal cavity).  Risk factors include nulliparity, early
                                                    menarche, and prolonged menses; in contrast, multiparity and late
                                                    menarche lower the risk due to fewer menstrual cycles (ie, fewer
                                                    opportunities for retrograde menstruation).</p>
<p class="" id="67de6602-bcfb-4217-b432-985925f08907">Like the uterine
                                                    endometrium, ectopic endometrium undergoes periods of proliferation
                                                    and breakdown concordant with the menstrual cycle.  Although
                                                    patients typically have regular menstrual cycles (eg, every 26 days,
                                                    lasting 5 days), shedding from ectopic endometrial glands can form
                                                    intraperitoneal blood collections, leading to dysmenorrhea.  Over
                                                    time, the blood undergoes hemolysis and induces pelvic inflammation
                                                    followed by adhesion formation, which, in turn, distorts pelvic
                                                    organ anatomy and function.</p>
<p class="" id="ce112706-06b8-438c-8c93-accf565e38e5">Pelvic
                                                    inflammation and adhesions can cause infertility by interfering with
                                                    ovulation, preventing fertilization by sperm, and inhibiting
                                                    implantation.  Tissue adhesions involving the uterosacral ligaments
                                                    can also cause a fixed, retroverted uterus.  In addition, nodular
                                                    implants within the posterior cul-de-sac can lead to painful
                                                    intercourse and tenderness with palpation of the posterior vaginal
                                                    fornix.</p>
<p class="" id="3a65c4a2-2a53-435b-8a24-4a2203c41814">(Choice B) 
                                                    Estrogen deficiency (eg, primary ovarian insufficiency, menopause)
                                                    can cause glycogen deficiency in the vaginal epithelium and
                                                    flattening of the vaginal rugae, which contribute to dyspareunia. 
                                                    However, this patient's regular menses indicate normal estrogen
                                                    levels.</p>
<p class="" id="dd1c6f22-62ed-4d4e-8c82-adb9369b4bdc">(Choice C) 
                                                    Endometrial hyperplasia increases the endometrial gland/stroma ratio
                                                    because the primary risk factor, excess estrogen stimulation,
                                                    preferentially stimulates glandular proliferation.  In contrast to
                                                    this patient with endometriosis, those with endometrial hyperplasia
                                                    typically have irregular, anovulatory menses.</p>
<p class="" id="f80d8f03-2c82-426e-85f6-c61356aa910a">(Choice D) 
                                                    Multiple ovarian follicular cysts with cortical fibrosis occur in
                                                    polycystic ovary syndrome (PCOS).  Although PCOS can cause
                                                    infertility due to anovulation, it is typically associated with
                                                    obesity, hyperandrogenism (eg, hirsutism, acne), and
                                                    oligomenorrhea.  This patient's regular menses make this
                                                    etiology unlikely.</p>
<p class="" id="fc7fe947-333b-468d-b531-8e893769ec78">(Choice E) 
                                                    Adenomyosis is the abnormal presence and proliferation of
                                                    endometrial glands within the uterine myometrium.  Although
                                                    adenomyosis can cause dysmenorrhea, patients typically have heavy
                                                    menses and a symmetrically enlarged uterus, which are not seen in
                                                    this patient.</p>
<p class="" id="c07e032a-2a96-466c-b762-547fb70e7ed8">Educational
                                                    objective:</p>
<p class="" id="120bb8d1-61d6-4827-87c8-b1c7366f4e16">Endometriosis is
                                                    the presence of endometrial glands and stroma in an extrauterine
                                                    location.  Ectopic implants within the intraperitoneal cavity
                                                    degenerate during menses and can cause abdominopelvic inflammation
                                                    and the formation of tissue adhesions.  Therefore, patients with
                                                    endometriosis may have dysmenorrhea, dyspareunia, and infertility.
                                                </p>
<p class="" id="dc35554f-ce30-46b2-a838-466c04a5b3c5">References</p>
<ul class="bulleted-list" id="9bd1d270-dc9e-427b-88f4-fc0a476ffd90">
<li style="list-style-type:disc"><a href="http://www.ncbi.nlm.nih.gov/pubmed/20573927">Clinical
                                                            practice. Endometriosis.</a></li>
</ul>
<ul class="bulleted-list" id="a39e8b94-bca2-47c4-893f-e2efc3d394a0">
<li style="list-style-type:disc"><a href="http://www.ncbi.nlm.nih.gov/pubmed/23182559">Endometriosis
                                                            and infertility: a review of the pathogenesis and treatment
                                                            of endometriosis-associated infertility.</a></li>
</ul>
<p class="" id="4bfc24f2-6784-429a-9857-1b5229f552ad">Pathology</p>
<p class="" id="d61502f9-c0f0-411c-8f5c-a4451d02cc23">Subject</p>
<p class="" id="2f619cf3-4d0c-41f3-ba88-6902f98229c1">Female
                                                    Reproductive System &amp; Breast</p>
<p class="" id="61fd281e-1d33-4625-b563-7bb34056f511">System</p>
<p class="" id="6195bb4e-dd00-46e0-9035-2a142fd0f05f">Endometriosis</p>
<p class="" id="e69f1098-9e9b-448e-ab20-eed50ec1ead4">Topic</p>
<p class="" id="c9eba893-bdf9-4979-989b-23ec6f49e28f">Copyright ¬©
                                                    UWorld. All rights reserved.</p>
<p class="" id="172bc2e0-406a-4bfc-a5ab-224833950e2e">üÖ±Ô∏è5üÖ∞Ô∏è1üïí0.5 sec
                                                </p>
<p class="" id="42418e29-96a7-44ea-8365-e2a7cb90b1bf">Exhibit Display
                                                </p>
<figure class="image" id="0771b449-82ce-4571-80bb-924ea899696a"><a href="https://lh7-us.googleusercontent.com/bUXdtjwfCJe--yngnAWlJ9Hm-pWRI8MgmcD61SuO4S7sPMH7okDIM6TaLSXl0AENTQdH5KPcE9zFLo8xTholf_ZNM8R1AXMJWieGsPUuq-I9HY56znrV3DlXT6ZxcxCdyKDn_RFsyyYiB7SOqn3w7nU"><img loading="lazy" src="https://lh7-us.googleusercontent.com/bUXdtjwfCJe--yngnAWlJ9Hm-pWRI8MgmcD61SuO4S7sPMH7okDIM6TaLSXl0AENTQdH5KPcE9zFLo8xTholf_ZNM8R1AXMJWieGsPUuq-I9HY56znrV3DlXT6ZxcxCdyKDn_RFsyyYiB7SOqn3w7nU" style="width:453px"/></a>
</figure>
<p class="" id="5e911a3c-719d-437c-9eb5-54e206d42c30">Zoom InZoom Out 
                                                    ResetNew</p>
<p class="" id="1393eb96-7bda-4d35-bea9-4b8436d3ffa9">ExistingMy
                                                    Notebook</p>
<p class="" id="1d23ad82-5c0f-4362-9c93-acc08973d76a">Exhibit Display
                                                </p>
<figure class="image" id="36628a7a-456c-4709-8714-5de51008e19e"><a href="https://lh7-us.googleusercontent.com/Xb9RM5fnjE9F8QltXwehcF_NZQG4YqYBAhQa4N3bYUgFZnPv2A1YsBeFkHLLAW0vnvvyr3HOw78S7mCxuluCaXYuTIHwKDwmNbW4JEyomWNlvLNEh20nVDjdKBw4o9BGVCztye774mRXBQ4GLmyut2M"><img loading="lazy" src="https://lh7-us.googleusercontent.com/Xb9RM5fnjE9F8QltXwehcF_NZQG4YqYBAhQa4N3bYUgFZnPv2A1YsBeFkHLLAW0vnvvyr3HOw78S7mCxuluCaXYuTIHwKDwmNbW4JEyomWNlvLNEh20nVDjdKBw4o9BGVCztye774mRXBQ4GLmyut2M" style="width:453px"/></a>
</figure>
<p class="" id="24dbd7e1-53c7-451c-8903-1f0570481333">Zoom InZoom Out 
                                                    ResetNew</p>
<p class="" id="57eb2f62-7d0d-4a6e-852a-483346223747">ExistingMy
                                                    Notebook</p>
<p class="" id="0a3a0a68-096f-4b0b-8591-888923719840">Exhibit Display
                                                </p>
<figure class="image" id="ff4c2cf2-ec02-48a3-8df2-acdfff0b321b"><a href="https://lh7-us.googleusercontent.com/ddMhwPm8VyjguUFJ5US5HXl5DGqp_nCNS2nG1XA5iaXsctWO_VoN-OokN-bGr7EtsZQKdN36JJwUi6l-fIyR0mtMz-4sJurisxdDbDVjh57WPdJ7dX2-XCo2gwBVGWUA0KLJ7Q3PrnwfGj2kcN22JhU"><img loading="lazy" src="https://lh7-us.googleusercontent.com/ddMhwPm8VyjguUFJ5US5HXl5DGqp_nCNS2nG1XA5iaXsctWO_VoN-OokN-bGr7EtsZQKdN36JJwUi6l-fIyR0mtMz-4sJurisxdDbDVjh57WPdJ7dX2-XCo2gwBVGWUA0KLJ7Q3PrnwfGj2kcN22JhU" style="width:602px"/></a>
</figure>
<p class="" id="9976e9c4-1df8-4d13-b45a-693e8a3fd12d">Zoom InZoom Out 
                                                    ResetNew</p>
<p class="" id="e6ff478b-a900-4f70-b20c-075e347cb352">ExistingMy
                                                    Notebook</p>
<p class="" id="7ad4759e-4a84-4e31-b3c5-78027a7596c6">Exhibit Display
                                                </p>
<figure class="image" id="47c82bc0-5b4e-46d4-a523-cdc391217f89"><a href="https://lh7-us.googleusercontent.com/vjqjfh3JlbFlyUZ2m6cErASvCjISUlA9gfSsmglnngHbQ25XXiucVi36XqH8AC0zil4sGb7c5v-SvhL2G44ljE8lGF4pXdUTUSBQuKq5QYK_aXlbZz6Y8PTAQGVwe8gC_yR3C8WnNe2wkbMCipoESQg"><img loading="lazy" src="https://lh7-us.googleusercontent.com/vjqjfh3JlbFlyUZ2m6cErASvCjISUlA9gfSsmglnngHbQ25XXiucVi36XqH8AC0zil4sGb7c5v-SvhL2G44ljE8lGF4pXdUTUSBQuKq5QYK_aXlbZz6Y8PTAQGVwe8gC_yR3C8WnNe2wkbMCipoESQg" style="width:602px"/></a>
</figure>
<p class="" id="4d2b2475-e661-4ff3-a71a-23738c0b41bd">Zoom InZoom Out 
                                                    ResetNew</p>
<p class="" id="8d661b9e-2ea5-4684-af32-c1d6ca533326">ExistingMy
                                                    Notebook</p>
<p class="" id="aa6acaa5-2c9a-4e24-b28f-263a91c93d5a">Exhibit Display
                                                </p>
<figure class="image" id="7a4cbf46-f498-4d3e-976b-cb14479a419b"><a href="https://lh7-us.googleusercontent.com/FqJU-tbfkWqp9TN-ztog_PpmhGpx2HjAgHjscu1Nvqlnkin1B5QjaKzVl-dgHPVQewMBYmge6TyubDgv2KWgfL8IG1TEDmPvOQKNYbUNdP2ueBRmL3N4bTjQdthvAcdA2YQajnXjJhq9k5T3AnuwnEA"><img loading="lazy" src="https://lh7-us.googleusercontent.com/FqJU-tbfkWqp9TN-ztog_PpmhGpx2HjAgHjscu1Nvqlnkin1B5QjaKzVl-dgHPVQewMBYmge6TyubDgv2KWgfL8IG1TEDmPvOQKNYbUNdP2ueBRmL3N4bTjQdthvAcdA2YQajnXjJhq9k5T3AnuwnEA" style="width:602px"/></a>
</figure>
<p class="" id="60c82c76-4e58-4eb3-a5fa-98928bcd25f7">Zoom InZoom Out 
                                                    ResetNew</p>
<p class="" id="409bb804-1c1b-4e0c-82ac-c274b07be7cd">ExistingMy
                                                    Notebook</p>
</details>
</li>
</ul>
</details>


















<style>
.bionic-reading-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.2);
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 8px;
    color: white;
    font-size: 20px;
    cursor: pointer;
    transition: all 0.3s;
    margin-left: auto;
    flex-shrink: 0;
}

.bionic-reading-btn:hover {
    background: rgba(255, 255, 255, 0.35);
    border-color: rgba(255, 255, 255, 0.5);
    transform: scale(1.1);
}

.bionic-reading-btn.active {
    background: rgba(52, 168, 83, 0.4);
    border-color: rgba(52, 168, 83, 0.6);
}

.bionic-reading-btn.active:hover {
    background: rgba(52, 168, 83, 0.5);
}

summary {
    display: flex !important;
    align-items: center !important;
    gap: 12px !important;
}

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }


    


    

    /* Adjust table padding to make room for radio button */
    


    


    


    


    /* Clickable Answer Choices */
    table tr.answer-choice {
        cursor: pointer !important;
        transition: all 0.3s ease !important;
    }

    table tr.answer-choice:hover {
        background: #f8f9fa !important;
    }

    table tr.answer-choice td:first-child {
        position: relative !important;
        padding-left: 35px !important;
    }

    table tr.answer-choice td:first-child::before {
        content: '';
        position: absolute;
        left: 8px;
        top: 50%;
        transform: translateY(-50%);
        width: 16px;
        height: 16px;
        border: 2px solid #999;
        border-radius: 50%;
        background: white;
        transition: all 0.2s ease;
        box-sizing: border-box;
    }

    table tr.answer-choice.selected td:first-child::before {
        border-color: #1a73e8;
        border-width: 5px;
    }

    table tr.answer-choice.selected {
        background: #e8f4ff !important;
    }

    table tr.answer-choice.selected td:first-child {
        color: #1a73e8 !important;
        font-weight: 600 !important;
    }


    


    /* Answer Validation Styles */
    tr.answer-choice.answer-correct {
        background: linear-gradient(90deg, #d4edda 0%, #c3e6cb 100%) !important;
        border: 3px solid #28a745 !important;
        border-radius: 8px !important;
        box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3) !important;
    }

    tr.answer-choice.answer-correct td {
        color: #155724 !important;
        font-weight: 600 !important;
    }

    tr.answer-choice.answer-correct td:first-child::before {
        border-color: #28a745 !important;
        background: #28a745 !important;
        box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.2) !important;
    }

    tr.answer-choice.answer-incorrect {
        background: linear-gradient(90deg, #f8d7da 0%, #f5c6cb 100%) !important;
        border: 3px solid #dc3545 !important;
        border-radius: 8px !important;
        box-shadow: 0 2px 8px rgba(220, 53, 69, 0.3) !important;
    }

    tr.answer-choice.answer-incorrect td {
        color: #721c24 !important;
        font-weight: 600 !important;
    }

    tr.answer-choice.answer-incorrect td:first-child::before {
        border-color: #dc3545 !important;
        background: #dc3545 !important;
        box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.2) !important;
    }


    /* Answer Validation Styles */
    tr.answer-choice.answer-correct {
        background: linear-gradient(90deg, #d4edda 0%, #c3e6cb 100%) !important;
        border: 3px solid #28a745 !important;
        border-radius: 8px !important;
        box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3) !important;
    }

    tr.answer-choice.answer-correct td {
        color: #155724 !important;
        font-weight: 600 !important;
    }

    tr.answer-choice.answer-correct td:first-child::before {
        border-color: #28a745 !important;
        background: #28a745 !important;
        box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.2) !important;
    }

    tr.answer-choice.answer-incorrect {
        background: linear-gradient(90deg, #f8d7da 0%, #f5c6cb 100%) !important;
        border: 3px solid #dc3545 !important;
        border-radius: 8px !important;
        box-shadow: 0 2px 8px rgba(220, 53, 69, 0.3) !important;
    }

    tr.answer-choice.answer-incorrect td {
        color: #721c24 !important;
        font-weight: 600 !important;
    }

    tr.answer-choice.answer-incorrect td:first-child::before {
        border-color: #dc3545 !important;
        background: #dc3545 !important;
        box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.2) !important;
    }

</style>



<script>
let bionicEnabled = false;
const originalContent = {};

function toggleBionicReading(event) {
    if (event) {
        event.preventDefault();
        event.stopPropagation();
    }

    bionicEnabled = !bionicEnabled;
    const btn = document.querySelector('.bionic-reading-btn');
    const icon = document.getElementById('bionicIcon');

    if (bionicEnabled) {
        btn.classList.add('active');
        icon.textContent = '‚úÖ';
        applyBionicReading();
    } else {
        btn.classList.remove('active');
        icon.textContent = 'üëÅÔ∏è';
        restoreOriginalText();
    }
}

function applyBionicReading() {
    // Seleciona todos os elementos de texto, EXCETO summary e buttons
    const textElements = document.querySelectorAll('p:not(summary p):not(button p), td:not(summary td):not(button td), li:not(summary li):not(button li)');

    textElements.forEach((element, index) => {
        // Ignora elementos que cont√™m outros elementos complexos
        if (element.querySelector('p, td, li, h1, h2, h3, h4, h5, h6, button, summary')) {
            return;
        }

        // Ignora se o elemento est√° dentro de um summary ou button
        if (element.closest('summary') || element.closest('button') || element.closest('.bionic-reading-btn')) {
            return;
        }

        // Salva o conte√∫do original
        if (!originalContent[index]) {
            originalContent[index] = {
                element: element,
                html: element.innerHTML
            };
        }

        // Aplica Bionic Reading
        const bionicText = convertToBionic(element.textContent);
        element.innerHTML = bionicText;
    });
}

function restoreOriginalText() {
    // Restaura o conte√∫do original
    Object.values(originalContent).forEach(item => {
        item.element.innerHTML = item.html;
    });
}

function convertToBionic(text) {
    // Divide o texto em palavras, mantendo pontua√ß√£o
    const words = text.split(/(\s+|[.,;:!?()""''\-‚Äì‚Äî])/);

    const bionicWords = words.map(word => {
        // Ignora espa√ßos e pontua√ß√£o
        if (word.match(/^\s+$/) || word.match(/^[.,;:!?()""''\-‚Äì‚Äî]+$/)) {
            return word;
        }

        // Ignora palavras muito curtas (1-2 letras)
        if (word.length <= 2) {
            return word;
        }

        // Determina quantas letras deixar em negrito (metade da palavra, arredondado para cima)
        const boldLength = Math.ceil(word.length / 2);

        // Separa a parte em negrito da parte normal
        const boldPart = word.substring(0, boldLength);
        const normalPart = word.substring(boldLength);

        // Retorna com a primeira parte em negrito
        return `<strong style="font-weight: 700 !important; color: inherit !important; background: none !important; padding: 0 !important;">${boldPart}</strong>${normalPart}`;
    });

    return bionicWords.join('');
}

// Adiciona atalho de teclado (Ctrl+B ou Cmd+B)
document.addEventListener('keydown', function(e) {
    if ((e.ctrlKey || e.metaKey) && e.key === 'b') {
        e.preventDefault();
        toggleBionicReading();
    }
});
</script>

<script>
    let highlighterActive = false;
    let questionHighlights = {};

    // Get question ID from the first summary strong tag
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Load highlights from localStorage
    function loadHighlights() {
        const questionId = getQuestionId();
        const stored = localStorage.getItem('highlights_' + questionId);
        if (stored) {
            questionHighlights = JSON.parse(stored);
            applyStoredHighlights();
        }
    }

    // Save highlights to localStorage
    function saveHighlights() {
        const questionId = getQuestionId();
        localStorage.setItem('highlights_' + questionId, JSON.stringify(questionHighlights));
    }

    // Apply stored highlights
    function applyStoredHighlights() {
        Object.keys(questionHighlights).forEach(key => {
            const element = document.querySelector(`[data-highlight-id="${key}"]`);
            if (element && questionHighlights[key]) {
                element.classList.add('highlighted');
            }
        });
    }

    // Toggle highlighter mode
    function toggleHighlighter(event) {
        event.stopPropagation();
        highlighterActive = !highlighterActive;

        const btn = event.target.closest('.highlighter-btn');
        const icon = btn.querySelector('#highlighterIcon');

        if (highlighterActive) {
            btn.classList.add('active');
            icon.textContent = 'üñçÔ∏è';
            document.body.classList.add('highlighter-mode-active');
        } else {
            btn.classList.remove('active');
            icon.textContent = 'üñäÔ∏è';
            document.body.classList.remove('highlighter-mode-active');
        }
    }

    // Clear all highlights for this question
    function clearHighlights() {
        const questionId = getQuestionId();
        questionHighlights = {};
        localStorage.removeItem('highlights_' + questionId);
        document.querySelectorAll('.highlighted').forEach(el => {
            el.classList.remove('highlighted');
        });
    }

    // Handle text selection and highlighting
    document.addEventListener('mouseup', function(e) {
        if (!highlighterActive) return;

        const selection = window.getSelection();
        if (!selection.toString().trim()) return;

        const range = selection.getRangeAt(0);
        const container = range.commonAncestorContainer;

        // Only highlight text in paragraphs, not in buttons or other elements
        const paragraph = container.nodeType === 3 ? container.parentElement : container;
        if (paragraph.tagName !== 'P' && paragraph.tagName !== 'LI' && paragraph.tagName !== 'TD') {
            return;
        }

        // Create highlight span
        const span = document.createElement('span');
        span.classList.add('highlighted');

        // Generate unique ID for this highlight
        const highlightId = 'hl-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
        span.setAttribute('data-highlight-id', highlightId);

        try {
            range.surroundContents(span);
            questionHighlights[highlightId] = true;
            saveHighlights();
        } catch (e) {
            console.log('Could not highlight selection');
        }

        selection.removeAllRanges();
    });

    // Load highlights when page loads
    window.addEventListener('load', loadHighlights);

    // Keyboard shortcut: Ctrl+H to toggle highlighter
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.key === 'h') {
            e.preventDefault();
            const btn = document.querySelector('.highlighter-btn');
            if (btn) {
                toggleHighlighter({target: btn, stopPropagation: () => {}});
            }
        }
        // Ctrl+Shift+H to clear all highlights
        if (e.ctrlKey && e.shiftKey && e.key === 'H') {
            e.preventDefault();
            if (confirm('Clear all highlights for this question?')) {
                clearHighlights();
            }
        }
    });
</script>







<script>
(function() {
    // Get question ID from summary
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Find the correct answer by highest percentage
    function findCorrectAnswer() {
        // Find the Submit or Explanation details element
        const submitDetails = Array.from(document.querySelectorAll('details')).find(d => {
            const summary = d.querySelector('summary');
            return summary && (summary.textContent.includes('Submit') || summary.textContent.includes('Explanation'));
        });

        if (!submitDetails) return null;

        // Find all answer rows with percentages inside Submit section
        const table = submitDetails.querySelector('table.simple-table');
        if (!table) return null;

        const rows = table.querySelectorAll('tr');
        let maxPercentage = -1;
        let correctChoice = null;

        rows.forEach(row => {
            const firstCell = row.querySelector('td:first-child');
            const secondCell = row.querySelector('td:nth-child(2)');

            if (firstCell && secondCell) {
                const choiceMatch = firstCell.textContent.trim().match(/^([A-Z])\./);
                const percentMatch = secondCell.textContent.match(/(\d+)%/);

                if (choiceMatch && percentMatch) {
                    const choice = choiceMatch[1];
                    const percentage = parseInt(percentMatch[1]);

                    if (percentage > maxPercentage) {
                        maxPercentage = percentage;
                        correctChoice = choice;
                    }
                }
            }
        });

        return correctChoice;
    }

    // Check user's answer when Submit is opened
    function checkAnswer() {
        const questionId = getQuestionId();
        const choiceKey = 'choice_q' + questionId;
        const userChoice = localStorage.getItem(choiceKey);

        if (!userChoice) {
            console.log('No answer selected');
            return;
        }

        const correctAnswer = findCorrectAnswer();
        if (!correctAnswer) {
            console.log('Could not determine correct answer');
            return;
        }

        const isCorrect = userChoice === correctAnswer;

        // Save result to localStorage
        const resultKey = 'result_q' + questionId;
        const resultValue = isCorrect ? 'correct' : 'incorrect';
        localStorage.setItem(resultKey, resultValue);

        // Force storage event for parent window
        try {
            window.dispatchEvent(new StorageEvent('storage', {
                key: resultKey,
                newValue: resultValue,
                storageArea: localStorage
            }));
        } catch (e) {
            console.log('Could not dispatch storage event:', e);
        }

        // Visual feedback - highlight the selected answer row
        const selectedRow = document.querySelector(`tr.answer-choice[data-choice="${userChoice}"]`);
        if (selectedRow) {
            // Remove any existing validation classes
            document.querySelectorAll('tr.answer-choice').forEach(row => {
                row.classList.remove('answer-correct', 'answer-incorrect');
            });

            // Add appropriate class
            if (isCorrect) {
                selectedRow.classList.add('answer-correct');
            } else {
                selectedRow.classList.add('answer-incorrect');

                // Also highlight the correct answer
                const correctRow = document.querySelector(`tr.answer-choice[data-choice="${correctAnswer}"]`);
                if (correctRow) {
                    correctRow.classList.add('answer-correct');
                }
            }
        }

        // Notify parent window
        if (window.parent && window.parent !== window) {
            window.parent.postMessage({
                type: 'answerValidated',
                questionId: questionId,
                userChoice: userChoice,
                correctAnswer: correctAnswer,
                isCorrect: isCorrect
            }, '*');
        }

        console.log(`Answer checked: User=${userChoice}, Correct=${correctAnswer}, Result=${isCorrect ? 'Correct' : 'Incorrect'}`);
    }

    // Monitor Submit or Explanation details opening
    function setupSubmitMonitor() {
        const submitDetails = Array.from(document.querySelectorAll('details')).find(d => {
            const summary = d.querySelector('summary');
            return summary && (summary.textContent.includes('Submit') || summary.textContent.includes('Explanation'));
        });

        if (submitDetails) {
            submitDetails.addEventListener('toggle', function() {
                if (this.open) {
                    // Small delay to ensure everything is rendered
                    setTimeout(checkAnswer, 100);
                }
            });
        }
    }

    // Initialize when page loads
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', setupSubmitMonitor);
    } else {
        setupSubmitMonitor();
    }
})();
</script>

<script>
(function() {
    // Get question ID from summary
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Communicate with parent window (if in iframe)
    function notifyParent(choice) {
        if (window.parent && window.parent !== window) {
            window.parent.postMessage({
                type: 'choiceSelected',
                questionId: getQuestionId(),
                choice: choice
            }, '*');
        }
    }

    // Load saved choice from parent or localStorage
    function loadSavedChoice() {
        const questionId = getQuestionId();

        // Try to get from localStorage first
        const saved = localStorage.getItem('choice_q' + questionId);
        if (saved) {
            selectChoice(saved, false);
        }

        // Ask parent for saved choice (if in iframe)
        if (window.parent && window.parent !== window) {
            window.parent.postMessage({
                type: 'getChoice',
                questionId: questionId
            }, '*');
        }
    }

    // Listen for messages from parent
    window.addEventListener('message', function(event) {
        if (event.data.type === 'setChoice' && event.data.questionId === getQuestionId()) {
            selectChoice(event.data.choice, false);
        }
    });

    // Select a choice
    function selectChoice(choice, notify = true) {
        if (!choice) return;

        const questionId = getQuestionId();

        // Remove previous selection
        document.querySelectorAll('tr.answer-choice').forEach(row => {
            row.classList.remove('selected');
        });

        // Add selection to clicked choice
        const choiceRow = document.querySelector(`tr.answer-choice[data-choice="${choice}"]`);
        if (choiceRow) {
            choiceRow.classList.add('selected');

            // Save to localStorage
            localStorage.setItem('choice_q' + questionId, choice);

            // Notify parent (if in iframe)
            if (notify) {
                notifyParent(choice);
            }
        }
    }

    // Initialize answer choices
    function initializeChoices() {
        // Find all answer choice rows (A, B, C, D, E, F, etc.)
        const choicePattern = /^[A-Z]\.$/;
        const tables = document.querySelectorAll('table.simple-table');

        tables.forEach(table => {
            const rows = table.querySelectorAll('tr');
            rows.forEach(row => {
                const firstCell = row.querySelector('td:first-child');
                if (firstCell && choicePattern.test(firstCell.textContent.trim())) {
                    const choice = firstCell.textContent.trim().replace('.', '');
                    row.classList.add('answer-choice');
                    row.setAttribute('data-choice', choice);
                    row.style.position = 'relative';

                    // Add click handler
                    row.addEventListener('click', function(e) {
                        // Don't trigger if clicking inside a link or button
                        if (e.target.tagName === 'A' || e.target.closest('a')) return;

                        // Toggle selection
                        if (this.classList.contains('selected')) {
                            this.classList.remove('selected');
                            const questionId = getQuestionId();
                            localStorage.removeItem('choice_q' + questionId);
                            notifyParent('');
                        } else {
                            selectChoice(choice);
                        }
                    });
                }
            });
        });

        // Load saved choice after a short delay
        setTimeout(loadSavedChoice, 100);
    }

    // Run when page loads
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeChoices);
    } else {
        initializeChoices();
    }
})();
</script>

<script>
(function() {
    // Get question ID from summary
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Find the correct answer by highest percentage
    function findCorrectAnswer() {
        // Find the Submit or Explanation details element
        const submitDetails = Array.from(document.querySelectorAll('details')).find(d => {
            const summary = d.querySelector('summary');
            return summary && (summary.textContent.includes('Submit') || summary.textContent.includes('Explanation'));
        });

        if (!submitDetails) return null;

        // Find all answer rows with percentages inside Submit section
        const table = submitDetails.querySelector('table.simple-table');
        if (!table) return null;

        const rows = table.querySelectorAll('tr');
        let maxPercentage = -1;
        let correctChoice = null;

        rows.forEach(row => {
            const firstCell = row.querySelector('td:first-child');
            const secondCell = row.querySelector('td:nth-child(2)');

            if (firstCell && secondCell) {
                const choiceMatch = firstCell.textContent.trim().match(/^([A-Z])\./);
                const percentMatch = secondCell.textContent.match(/(\d+)%/);

                if (choiceMatch && percentMatch) {
                    const choice = choiceMatch[1];
                    const percentage = parseInt(percentMatch[1]);

                    if (percentage > maxPercentage) {
                        maxPercentage = percentage;
                        correctChoice = choice;
                    }
                }
            }
        });

        return correctChoice;
    }

    // Check user's answer when Submit is opened
    function checkAnswer() {
        const questionId = getQuestionId();
        const choiceKey = 'choice_q' + questionId;
        const userChoice = localStorage.getItem(choiceKey);

        if (!userChoice) {
            console.log('No answer selected');
            return;
        }

        const correctAnswer = findCorrectAnswer();
        if (!correctAnswer) {
            console.log('Could not determine correct answer');
            return;
        }

        const isCorrect = userChoice === correctAnswer;

        // Save result to localStorage
        const resultKey = 'result_q' + questionId;
        const resultValue = isCorrect ? 'correct' : 'incorrect';
        localStorage.setItem(resultKey, resultValue);

        // Force storage event for parent window
        try {
            window.dispatchEvent(new StorageEvent('storage', {
                key: resultKey,
                newValue: resultValue,
                storageArea: localStorage
            }));
        } catch (e) {
            console.log('Could not dispatch storage event:', e);
        }

        // Visual feedback - highlight the selected answer row
        const selectedRow = document.querySelector(`tr.answer-choice[data-choice="${userChoice}"]`);
        if (selectedRow) {
            // Remove any existing validation classes
            document.querySelectorAll('tr.answer-choice').forEach(row => {
                row.classList.remove('answer-correct', 'answer-incorrect');
            });

            // Add appropriate class
            if (isCorrect) {
                selectedRow.classList.add('answer-correct');
            } else {
                selectedRow.classList.add('answer-incorrect');

                // Also highlight the correct answer
                const correctRow = document.querySelector(`tr.answer-choice[data-choice="${correctAnswer}"]`);
                if (correctRow) {
                    correctRow.classList.add('answer-correct');
                }
            }
        }

        // Notify parent window
        if (window.parent && window.parent !== window) {
            window.parent.postMessage({
                type: 'answerValidated',
                questionId: questionId,
                userChoice: userChoice,
                correctAnswer: correctAnswer,
                isCorrect: isCorrect
            }, '*');
        }

        console.log(`Answer checked: User=${userChoice}, Correct=${correctAnswer}, Result=${isCorrect ? 'Correct' : 'Incorrect'}`);
    }

    // Monitor Submit or Explanation details opening
    function setupSubmitMonitor() {
        const submitDetails = Array.from(document.querySelectorAll('details')).find(d => {
            const summary = d.querySelector('summary');
            return summary && (summary.textContent.includes('Submit') || summary.textContent.includes('Explanation'));
        });

        if (submitDetails) {
            submitDetails.addEventListener('toggle', function() {
                if (this.open) {
                    // Small delay to ensure everything is rendered
                    setTimeout(checkAnswer, 100);
                }
            });
        }
    }

    // Initialize when page loads
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', setupSubmitMonitor);
    } else {
        setupSubmitMonitor();
    }
})();
</script>

<script>
(function() {
    // Get question ID from summary
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Find the correct answer by highest percentage
    function findCorrectAnswer() {
        // Find the Submit or Explanation details element
        const submitDetails = Array.from(document.querySelectorAll('details')).find(d => {
            const summary = d.querySelector('summary');
            return summary && (summary.textContent.includes('Submit') || summary.textContent.includes('Explanation'));
        });

        if (!submitDetails) return null;

        // Find all answer rows with percentages inside Submit section
        const table = submitDetails.querySelector('table.simple-table');
        if (!table) return null;

        const rows = table.querySelectorAll('tr');
        let maxPercentage = -1;
        let correctChoice = null;

        rows.forEach(row => {
            const firstCell = row.querySelector('td:first-child');
            const secondCell = row.querySelector('td:nth-child(2)');

            if (firstCell && secondCell) {
                const choiceMatch = firstCell.textContent.trim().match(/^([A-Z])\./);
                const percentMatch = secondCell.textContent.match(/(\d+)%/);

                if (choiceMatch && percentMatch) {
                    const choice = choiceMatch[1];
                    const percentage = parseInt(percentMatch[1]);

                    if (percentage > maxPercentage) {
                        maxPercentage = percentage;
                        correctChoice = choice;
                    }
                }
            }
        });

        return correctChoice;
    }

    // Check user's answer when Submit is opened
    function checkAnswer() {
        const questionId = getQuestionId();
        const choiceKey = 'choice_q' + questionId;
        const userChoice = localStorage.getItem(choiceKey);

        if (!userChoice) {
            console.log('No answer selected');
            return;
        }

        const correctAnswer = findCorrectAnswer();
        if (!correctAnswer) {
            console.log('Could not determine correct answer');
            return;
        }

        const isCorrect = userChoice === correctAnswer;

        // Save result to localStorage
        const resultKey = 'result_q' + questionId;
        const resultValue = isCorrect ? 'correct' : 'incorrect';
        localStorage.setItem(resultKey, resultValue);

        // Force storage event for parent window
        try {
            window.dispatchEvent(new StorageEvent('storage', {
                key: resultKey,
                newValue: resultValue,
                storageArea: localStorage
            }));
        } catch (e) {
            console.log('Could not dispatch storage event:', e);
        }

        // Visual feedback - highlight the selected answer row
        const selectedRow = document.querySelector(`tr.answer-choice[data-choice="${userChoice}"]`);
        if (selectedRow) {
            // Remove any existing validation classes
            document.querySelectorAll('tr.answer-choice').forEach(row => {
                row.classList.remove('answer-correct', 'answer-incorrect');
            });

            // Add appropriate class
            if (isCorrect) {
                selectedRow.classList.add('answer-correct');
            } else {
                selectedRow.classList.add('answer-incorrect');

                // Also highlight the correct answer
                const correctRow = document.querySelector(`tr.answer-choice[data-choice="${correctAnswer}"]`);
                if (correctRow) {
                    correctRow.classList.add('answer-correct');
                }
            }
        }

        // Notify parent window
        if (window.parent && window.parent !== window) {
            window.parent.postMessage({
                type: 'answerValidated',
                questionId: questionId,
                userChoice: userChoice,
                correctAnswer: correctAnswer,
                isCorrect: isCorrect
            }, '*');
        }

        console.log(`Answer checked: User=${userChoice}, Correct=${correctAnswer}, Result=${isCorrect ? 'Correct' : 'Incorrect'}`);
    }

    // Monitor Submit or Explanation details opening
    function setupSubmitMonitor() {
        const submitDetails = Array.from(document.querySelectorAll('details')).find(d => {
            const summary = d.querySelector('summary');
            return summary && (summary.textContent.includes('Submit') || summary.textContent.includes('Explanation'));
        });

        if (submitDetails) {
            submitDetails.addEventListener('toggle', function() {
                if (this.open) {
                    // Small delay to ensure everything is rendered
                    setTimeout(checkAnswer, 100);
                }
            });
        }
    }

    // Initialize when page loads
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', setupSubmitMonitor);
    } else {
        setupSubmitMonitor();
    }
})();
</script>

<script>
(function() {
    // Get question ID from summary
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Find the correct answer by highest percentage
    function findCorrectAnswer() {
        // Find the Submit or Explanation details element
        const submitDetails = Array.from(document.querySelectorAll('details')).find(d => {
            const summary = d.querySelector('summary');
            return summary && (summary.textContent.includes('Submit') || summary.textContent.includes('Explanation'));
        });

        if (!submitDetails) return null;

        // Find all answer rows with percentages inside Submit section
        const table = submitDetails.querySelector('table.simple-table');
        if (!table) return null;

        const rows = table.querySelectorAll('tr');
        let maxPercentage = -1;
        let correctChoice = null;

        rows.forEach(row => {
            const firstCell = row.querySelector('td:first-child');
            const secondCell = row.querySelector('td:nth-child(2)');

            if (firstCell && secondCell) {
                const choiceMatch = firstCell.textContent.trim().match(/^([A-Z])\./);
                const percentMatch = secondCell.textContent.match(/(\d+)%/);

                if (choiceMatch && percentMatch) {
                    const choice = choiceMatch[1];
                    const percentage = parseInt(percentMatch[1]);

                    if (percentage > maxPercentage) {
                        maxPercentage = percentage;
                        correctChoice = choice;
                    }
                }
            }
        });

        return correctChoice;
    }

    // Check user's answer when Submit is opened
    function checkAnswer() {
        const questionId = getQuestionId();
        const choiceKey = 'choice_q' + questionId;
        const userChoice = localStorage.getItem(choiceKey);

        if (!userChoice) {
            console.log('No answer selected');
            return;
        }

        const correctAnswer = findCorrectAnswer();
        if (!correctAnswer) {
            console.log('Could not determine correct answer');
            return;
        }

        const isCorrect = userChoice === correctAnswer;

        // Save result to localStorage
        const resultKey = 'result_q' + questionId;
        const resultValue = isCorrect ? 'correct' : 'incorrect';
        localStorage.setItem(resultKey, resultValue);

        // Force storage event for parent window
        try {
            window.dispatchEvent(new StorageEvent('storage', {
                key: resultKey,
                newValue: resultValue,
                storageArea: localStorage
            }));
        } catch (e) {
            console.log('Could not dispatch storage event:', e);
        }

        // Visual feedback - highlight the selected answer row
        const selectedRow = document.querySelector(`tr.answer-choice[data-choice="${userChoice}"]`);
        if (selectedRow) {
            // Remove any existing validation classes
            document.querySelectorAll('tr.answer-choice').forEach(row => {
                row.classList.remove('answer-correct', 'answer-incorrect');
            });

            // Add appropriate class
            if (isCorrect) {
                selectedRow.classList.add('answer-correct');
            } else {
                selectedRow.classList.add('answer-incorrect');

                // Also highlight the correct answer
                const correctRow = document.querySelector(`tr.answer-choice[data-choice="${correctAnswer}"]`);
                if (correctRow) {
                    correctRow.classList.add('answer-correct');
                }
            }
        }

        // Notify parent window
        if (window.parent && window.parent !== window) {
            window.parent.postMessage({
                type: 'answerValidated',
                questionId: questionId,
                userChoice: userChoice,
                correctAnswer: correctAnswer,
                isCorrect: isCorrect
            }, '*');
        }

        console.log(`Answer checked: User=${userChoice}, Correct=${correctAnswer}, Result=${isCorrect ? 'Correct' : 'Incorrect'}`);
    }

    // Monitor Submit or Explanation details opening
    function setupSubmitMonitor() {
        const submitDetails = Array.from(document.querySelectorAll('details')).find(d => {
            const summary = d.querySelector('summary');
            return summary && (summary.textContent.includes('Submit') || summary.textContent.includes('Explanation'));
        });

        if (submitDetails) {
            submitDetails.addEventListener('toggle', function() {
                if (this.open) {
                    // Small delay to ensure everything is rendered
                    setTimeout(checkAnswer, 100);

                    // Notify parent that Submit/Explanation was opened
                    if (window.parent && window.parent !== window) {
                        window.parent.postMessage({
                            type: 'submitOpened',
                            questionId: getQuestionId()
                        }, '*');
                    }
                } else {
                    // Notify parent that Submit/Explanation was closed
                    if (window.parent && window.parent !== window) {
                        window.parent.postMessage({
                            type: 'submitClosed',
                            questionId: getQuestionId()
                        }, '*');
                    }
                }
            });
        }
    }

    // Initialize when page loads
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', setupSubmitMonitor);
    } else {
        setupSubmitMonitor();
    }
})();
</script>
