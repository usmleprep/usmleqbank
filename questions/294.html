
<style>
    * {
        box-sizing: border-box !important;
    }

    body {
        font-family: 'Inter', 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif !important;
        line-height: 1.9 !important;
        color: #1f1f1f !important;
        max-width: none !important;
        margin: 0 !important;
        padding: 8px 16px 16px 16px !important;
        background: #ffffff !important;
        font-size: 16.5px !important;
    }

    p {
        margin-bottom: 20px !important;
        font-size: 16.5px !important;
        line-height: 1.95 !important;
        color: #1f1f1f !important;
        font-weight: 400 !important;
    }

    strong, b {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        background: rgba(26, 115, 232, 0.08) !important;
        padding: 2px 6px !important;
        border-radius: 8px !important;
    }

    /* Details/Summary (collapsible sections) */
    details {
        background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%) !important;
        border-radius: 8px !important;
        padding: 24px 28px !important;
        margin: 24px 0 !important;
        border: none;
        box-shadow: none !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
    }

    details:hover {
        border-color: #1a73e8 !important;
        box-shadow: none !important;
        transform: translateY(-2px) !important;
    }

    details[open] {
        background: #ffffff !important;
        border-color: #1a73e8 !important;
        box-shadow: none !important;
    }

    summary {
        cursor: pointer !important;
        font-weight: 800 !important;
        color: #ffffff !important;
        font-size: 20px !important;
        padding: 16px 24px !important;
        border-radius: 8px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
        display: flex !important;
        align-items: center !important;
        user-select: none !important;
        box-shadow: none !important;
        letter-spacing: 0.5px !important;
    }

    summary:hover {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        transform: translateX(6px) scale(1.02) !important;
        box-shadow: none !important;
    }

    summary:active {
        transform: translateX(4px) scale(0.99) !important;
    }

    summary::marker {
        color: rgba(255, 255, 255, 0.9) !important;
        font-size: 1.3em !important;
    }

    summary strong {
        background: rgba(255, 255, 255, 0.2) !important;
        color: #ffffff !important;
        padding: 4px 12px !important;
        border-radius: 8px !important;
        margin-left: 8px !important;
        font-size: 19px !important;
        letter-spacing: 1px !important;
    }

    /* Tables - Premium Design */
    table {
        width: 100% !important;
        border-collapse: separate !important;
        border-spacing: 0 !important;
        margin: 28px 0 !important;
        border-radius: 8px !important;
        overflow: hidden !important;
        box-shadow: none !important;
        border: none !important;
        background: #ffffff !important;
    }

    table.simple-table {
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%) !important;
    }

    table tr {
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1) !important;
        position: relative !important;
    }

    table tr:nth-child(odd) {
        background: rgba(248, 249, 250, 0.5) !important;
    }

    table tr:nth-child(even) {
        background: rgba(255, 255, 255, 0.8) !important;
    }

    table tr:hover {
        background: linear-gradient(90deg, #e8f0fe 0%, #f1f8ff 100%) !important;
        transform: translateX(4px) scale(1.01) !important;
        box-shadow: none !important;
        z-index: 1 !important;
    }

    table td {
        padding: 18px 24px !important;
        border-bottom: 1px solid rgba(232, 234, 237, 0.6) !important;
        font-size: 16.5px !important;
        line-height: 1.7 !important;
        color: #1f1f1f !important;
        vertical-align: middle !important;
    }

    table tr:last-child td {
        border-bottom: none !important;
    }

    /* First column (A, B, C, D, E) */
    table td:first-child {
        font-weight: 800 !important;
        color: #ffffff !important;
        width: 52px !important;
        text-align: center !important;
        font-size: 18px !important;
        background: linear-gradient(135deg, #1a73e8 0%, #1557b0 100%) !important;
        border-right: 3px solid #1557b0 !important;
        position: relative !important;
        letter-spacing: 0.5px !important;
    }

    table tr:hover td:first-child {
        background: linear-gradient(135deg, #1557b0 0%, #0d47a1 100%) !important;
        box-shadow: none !important;
    }

    /* Second column (content) */
    table td:nth-child(2) {
        font-weight: 500 !important;
        padding-left: 28px !important;
    }

    /* Third column (empty - hide it) */
    table td:last-child:empty {
        display: none !important;
    }

    /* Lists */
    ul, ol {
        margin: 16px 0 !important;
        padding-left: 32px !important;
    }

    li {
        margin: 10px 0 !important;
        line-height: 1.8 !important;
        color: #1f1f1f !important;
    }

    ul.bulleted-list li {
        position: relative !important;
        padding-left: 8px !important;
    }

    ul.toggle {
        list-style: none !important;
        padding-left: 0 !important;
    }

    /* Links */
    a {
        color: #1a73e8 !important;
        text-decoration: none !important;
        font-weight: 600 !important;
        border-bottom: 2px solid transparent !important;
        transition: all 0.2s !important;
    }

    a:hover {
        border-bottom-color: #1a73e8 !important;
        background: rgba(26,115,232,0.08) !important;
        padding: 2px 4px !important;
        border-radius: 8px !important;
    }

    /* Images & Media */
    img, video {
        max-width: none !important;
        height: auto !important;
        border-radius: 8px !important;
        box-shadow: none !important;
        margin: 24px 0 !important;
        display: block !important;
        border: none !important;
    }

    img:hover, video:hover {
        box-shadow: none !important;
        border-color: #1a73e8 !important;
    }

    /* Code blocks (if any) */
    code {
        background: #f1f3f4 !important;
        padding: 2px 8px !important;
        border-radius: 8px !important;
        font-family: 'Courier New', monospace !important;
        font-size: 14px !important;
        color: #d93025 !important;
    }

    pre {
        background: #f8f9fa !important;
        padding: 8px 16px 16px 16px !important;
        border-radius: 8px !important;
        overflow-x: auto !important;
        border-left: 4px solid #1a73e8 !important;
    }

    /* Headings */
    h1, h2, h3, h4, h5, h6 {
        color: #1a73e8 !important;
        font-weight: 700 !important;
        margin-top: 24px !important;
        margin-bottom: 16px !important;
        line-height: 1.4 !important;
    }

    h1 { font-size: 32px !important; }
    h2 { font-size: 26px !important; }
    h3 { font-size: 22px !important; }
    h4 { font-size: 19px !important; }

    /* Blockquotes */
    blockquote {
        border-left: 4px solid #1a73e8 !important;
        padding-left: 20px !important;
        margin: 20px 0 !important;
        font-style: italic !important;
        color: #5f6368 !important;
        background: #f8f9fa !important;
        padding: 16px 20px !important;
        border-radius: 8px !important;
    }

    /* Horizontal Rule */
    hr {
        border: none !important;
        height: 2px !important;
        background: linear-gradient(to right, transparent, #1a73e8, transparent) !important;
        margin: 32px 0 !important;
    }

    /* Selection */
    ::selection {
        background: #e8f0fe !important;
        color: #1a73e8 !important;
    }

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }

</style>




<details open>
<summary><strong>294</strong><button class="bionic-reading-btn" onclick="toggleBionicReading(event)" title="Toggle Bionic Reading (Ctrl+B)"><span id="bionicIcon">üëÅÔ∏è</span></button><button class="highlighter-btn" onclick="toggleHighlighter(event)" title="Toggle Highlighter (Ctrl+H)"><span id="highlighterIcon">üñäÔ∏è</span></button></summary>
<p class="" id="41a54327-eef3-48dc-92fc-2ff58bf9ba73">A 9-year-old boy with
                                        beta-thalassemia major is brought to the office for a routine red blood cell
                                        transfusion.  He was diagnosed at age 6 months and has since received numerous
                                        blood transfusions.  The patient has tolerated each transfusion well with no
                                        immediate reactions.  Vital signs are normal.  On physical examination, the
                                        patient has mild frontal bossing, hepatosplenomegaly, and jaundice.  A recent
                                        liver biopsy showed Kupffer cells containing coarse, yellow-brown cytoplasmic
                                        granules.  The granules are most likely composed of which of the following?</p>
<table class="simple-table" id="12debcbc-6d00-4c13-aded-005870d9b8ff">
<tbody>
<tr id="00687ebd-4c40-4312-8afe-ecd98e06121a">
<td class="" id="EnR:">A.</td>
<td class="" id="wCDP">Amyloid</td>
<td class="" id="T}aR"></td>
</tr>
<tr id="1e18120b-7baf-4417-9b2e-938e4caf452e">
<td class="" id="EnR:">B.</td>
<td class="" id="wCDP">Bilirubin</td>
<td class="" id="T}aR"></td>
</tr>
<tr id="045188f2-62d0-4603-822e-3d692056cf2f">
<td class="" id="EnR:">C.</td>
<td class="" id="wCDP">Copper</td>
<td class="" id="T}aR"></td>
</tr>
<tr id="8275da9b-351d-4f42-96f5-6b4773a39f9c">
<td class="" id="EnR:">D.</td>
<td class="" id="wCDP">Glycogen</td>
<td class="" id="T}aR"></td>
</tr>
<tr id="a976fa0b-dd0d-4c2d-b904-67e3c0d294d6">
<td class="" id="EnR:">E.</td>
<td class="" id="wCDP">Glycolipid</td>
<td class="" id="T}aR"></td>
</tr>
<tr id="e7db5714-98f5-4420-993c-74e68894e260">
<td class="" id="EnR:">F.</td>
<td class="" id="wCDP">Hemosiderin</td>
<td class="" id="T}aR"></td>
</tr>
<tr id="bd4b2fa7-f092-4ff1-be0c-9e214cf8fe74">
<td class="" id="EnR:">G.</td>
<td class="" id="wCDP">Lipofuscin</td>
<td class="" id="T}aR"></td>
</tr>
</tbody>
</table>
<ul class="toggle" id="a46368df-e628-4bda-964f-6f6225d0d7ae">
<li>
<details>
<summary>Submit</summary>
<table class="simple-table" id="b07d341f-6ca1-4f87-93f7-2554f0339ecd">
<tbody>
<tr id="9f27273a-2629-48ba-bcbf-c70090298350">
<td class="" id="qHj{">A.</td>
<td class="" id="LMVE">Amyloid (1%)</td>
<td class="" id="x&lt;m]"></td>
</tr>
<tr id="b59f6012-5434-4483-9375-1eedc305a260">
<td class="" id="qHj{">B.</td>
<td class="" id="LMVE">Bilirubin (8%)</td>
<td class="" id="x&lt;m]"></td>
</tr>
<tr id="bff6f445-59ef-4dfd-baae-7b0739bf0be4">
<td class="" id="qHj{">C.</td>
<td class="" id="LMVE">Copper (3%)</td>
<td class="" id="x&lt;m]"></td>
</tr>
<tr id="ee38c58a-b08f-4ed5-bbcb-64f9194dd868">
<td class="" id="qHj{">D.</td>
<td class="" id="LMVE">Glycogen (0%)</td>
<td class="" id="x&lt;m]"></td>
</tr>
<tr id="937a3718-df59-4e70-9982-f495096daeb7">
<td class="" id="qHj{">E.</td>
<td class="" id="LMVE">Glycolipid (0%)</td>
<td class="" id="x&lt;m]"></td>
</tr>
<tr id="1e92d6ab-32ab-4567-a057-cf6087882b62">
<td class="" id="qHj{">F.</td>
<td class="" id="LMVE">Hemosiderin (76%)</td>
<td class="" id="x&lt;m]"></td>
</tr>
<tr id="088c7097-97c7-44a4-a3c4-80c324cc0699">
<td class="" id="qHj{">G.</td>
<td class="" id="LMVE">Lipofuscin (8%)</td>
<td class="" id="x&lt;m]"></td>
</tr>
</tbody>
</table>
<p class="" id="d7aface5-4e42-478e-99e6-cc2c6d9f19f2">Incorrect</p>
<p class="" id="1e6bbffb-4e7f-4371-a201-cdbc22ce3948">Correct answer F
                                                </p>
<p class="" id="8a45641d-ec69-4eaa-a2f7-cb9bc08621bc">76%Answered
                                                    correctly</p>
<p class="" id="14b5bd9e-871c-4b13-be21-433abc35842f">25 secsTime Spent
                                                </p>
<p class="" id="177472f4-8906-47d1-b3d7-1f62cc5354f8">2024Version</p>
<ul class="bulleted-list" id="1aea25c3-1ccc-404e-a510-324667d59a12">
<li style="list-style-type:disc">Explanation</li>
</ul>
<ul class="bulleted-list" id="48d19f96-0ee3-48ab-abb3-4e7789a29805">
<li style="list-style-type:disc"></li>
</ul>
<p class="" id="1e7d9c52-4aaa-4184-b467-573ed3e18ba9">Patients with
                                                    chronic hemolytic anemia (eg, beta-thalassemia major) depend on
                                                    recurrent red blood cell (RBC) transfusions to maintain an adequate
                                                    hemoglobin level.  Iron overload (hemosiderosis) from increased iron
                                                    absorption is a common complication resulting from both the primary
                                                    condition (eg, hemolysis) and its treatment (frequent RBC
                                                    transfusions).</p>
<p class="" id="2edb88cf-0bb7-4cae-8c2e-dc44bb90834d">Circulating iron
                                                    is carried by transferrin.  Once deposited in cells, iron binds to
                                                    apoferritin to form ferritin micelles.  Because iron is used poorly
                                                    in patients with thalassemia and cannot be excreted actively, the
                                                    ferritin micelles accumulate in macrophages of the
                                                    reticuloendothelial system.  The resulting iron-storage complex is
                                                    known as hemosiderin and microscopically appears as brown or
                                                    yellow-brown pigments in either granular or crystalline form. 
                                                    Hemosiderin can be confirmed histologically with Prussian-blue
                                                    staining.  In the liver, hemosiderin is typically seen in Kupffer
                                                    cells (hepatic macrophages that line the walls of the sinusoids and
                                                    participate in RBC breakdown).</p>
<p class="" id="52591b57-f595-4159-b3ab-400741cb45f2">Eventually, the
                                                    iron burden will overwhelm the reticuloendothelial cells'
                                                    capacity to sequester iron, resulting in parenchymal iron overload
                                                    in the liver, myocardium, skin, and pancreas (eg, "bronze
                                                    diabetes").  Patients receiving regular transfusions should
                                                    undergo routine iron chelation therapy to reduce the overall iron
                                                    load within the body and improve survival.</p>
<p class="" id="7e252940-e9d2-4a32-9ad0-7cc1b48d8058">(Choice A) 
                                                    Amyloid protein appears as an amorphous, pink, extracellular
                                                    material that shows apple-green birefringence under polarized light
                                                    after Congo red staining.  Hepatic amyloid can be seen in primary
                                                    (eg, multiple myeloma) or secondary (eg, chronic inflammation)
                                                    amyloidosis.</p>
<p class="" id="6345443c-2210-4658-babf-6793a96e2625">(Choice B) 
                                                    Bilirubin is the primary pigment found within bile, which has a
                                                    brown, yellow, or green appearance microscopically.  Accumulation in
                                                    hepatocytes and canaliculi (ie, cholestasis) is associated with
                                                    defects in bile production or flow (eg, duct obstruction).</p>
<p class="" id="12356331-02c9-410a-9229-3f31ef52649c">(Choice C)  Copper
                                                    accumulation is seen in Wilson disease, an autosomal recessive
                                                    disease characterized by cirrhosis and neurologic complications.</p>
<p class="" id="fcaedfa9-b585-4362-a677-872a73ac3123">(Choice D) 
                                                    Glycogen appears as clear cytoplasmic vacuoles and stains
                                                    pink-purple with the periodic acid-Schiff reaction.  Glycogen is
                                                    abundant in the liver shortly after a meal.</p>
<p class="" id="1c58a925-3035-4af8-8f76-92b88d40b0ef">(Choice E) 
                                                    Patients with Gaucher disease (glucocerebrosidase enzyme deficiency)
                                                    have pancytopenia, hepatosplenomegaly, and pathologic fractures. 
                                                    Gaucher cells, macrophages laden with cerebrosides and other
                                                    glycolipids, have a "wrinkled tissue paper" appearance
                                                    microscopically.</p>
<p class="" id="40ceb8e8-e74d-4957-b396-d3f87756a9ac">(Choice G) 
                                                    Lipofuscin is an insoluble yellow-brown pigment composed of lipids
                                                    and phospholipids complexed with proteins.  This pigment accumulates
                                                    with age (ie, typically seen in adults) and "wear and
                                                    tear" of multiple organs.</p>
<p class="" id="e5572df6-95b1-49c0-acee-98ecbaf16515">Educational
                                                    objective:</p>
<p class="" id="be199efd-0112-4a40-9179-92c01ac7b218">Iron overload
                                                    (hemosiderosis) is a common and serious complication of chronic
                                                    hemolytic anemia and frequent blood transfusions.  Accumulation of
                                                    yellow-brown hemosiderin pigment is the cardinal histologic
                                                    finding.  Chelation therapy is indicated to reduce parenchymal iron
                                                    deposition.</p>
<p class="" id="ad62a0b2-88a3-40bd-bcd0-fdaa8bd83e95">References</p>
<ul class="bulleted-list" id="b486a763-0ae7-418e-a377-e6d5eb0e306d">
<li style="list-style-type:disc"><a href="http://www.ncbi.nlm.nih.gov/pubmed/17486050">Iron
                                                            overload syndromes and the liver.</a></li>
</ul>
<ul class="bulleted-list" id="c85d5413-10f0-4668-b541-25832f0f366b">
<li style="list-style-type:disc"><a href="http://www.ncbi.nlm.nih.gov/pubmed/24790662">Iron
                                                            overload in beta thalassaemia major and intermedia
                                                            patients.</a></li>
</ul>
<p class="" id="84674386-0e4d-422a-bae3-3305bea246db">Pathology</p>
<p class="" id="edf56027-edb0-41ab-a029-1bd6cdc1bdf3">Subject</p>
<p class="" id="efbab732-9041-4094-92f6-02bb976eebba">Hematology &amp;
                                                    Oncology</p>
<p class="" id="ac8a19ac-b956-49ed-9fa2-ee61f3312a5c">System</p>
<p class="" id="8ef26cff-0ac4-4692-8aba-09189675e5dd">Hemolytic anemia
                                                </p>
<p class="" id="812ce074-c3ad-4005-8047-99dc7bc8435a">Topic</p>
<p class="" id="171038a2-15a5-4083-9e59-60d019bf703d">Copyright ¬©
                                                    UWorld. All rights reserved.</p>
<p class="" id="225fa480-e646-4f33-b229-f2aab4c23a9a">My Notebook</p>
<p class="" id="fe61d105-0c72-42d2-9740-c89c6b696892">0</p>
<p class="" id="0da58191-ed94-4d12-af16-3d4f85468969">Flashcards</p>
<p class="" id="e7344786-d2aa-45a6-bb4d-d642253a7e18">Feedback</p>
<p class="" id="d184f7f4-41fb-4a27-8714-081dba5e44dd">Suspend</p>
<p class="" id="004d57fb-825a-4f96-b45d-3f44c9317e61">End Block</p>
<p class="" id="dcd790e0-6bdc-4130-b5b6-0c6d8f49ad51">‚ú®Done</p>
<p class="" id="5a3e9bd7-7ee2-4f53-8093-3d85e6fc20ef">Exhibit Display
                                                </p>
<figure class="image" id="4892ad81-929e-4b41-95b6-3cae7dbb848d"><a href="https://lh7-us.googleusercontent.com/imVYwiPX8ac6cfAxWP5RV6Kiw6r6ulH4oB7iIj_sCKgEaPav7HjjMGBPK5x_hJz2HBDBvzuBCKDu29OLYfvavc9zN_adzYGOpxn_jqdqCPCSSSgQZqJYv3xIG-KjwB-Cbn57TDLMMcJq39rh5VcZXA"><img loading="lazy" src="https://lh7-us.googleusercontent.com/imVYwiPX8ac6cfAxWP5RV6Kiw6r6ulH4oB7iIj_sCKgEaPav7HjjMGBPK5x_hJz2HBDBvzuBCKDu29OLYfvavc9zN_adzYGOpxn_jqdqCPCSSSgQZqJYv3xIG-KjwB-Cbn57TDLMMcJq39rh5VcZXA" style="width:602px"/></a>
</figure>
<p class="" id="bb655b2f-fbb4-48e3-b721-fed374ccd5ef">Zoom InZoom Out 
                                                    ResetNew</p>
<p class="" id="ceb4a955-18a7-4341-9f05-24a53d356312">ExistingMy
                                                    Notebook</p>
<p class="" id="88db5dfe-b152-4806-a2b7-a9fabb474ea2">Exhibit Display
                                                </p>
<figure class="image" id="124cd9aa-8ec6-4201-a205-bb7327c19de6"><a href="https://lh7-us.googleusercontent.com/Y1hgAmltswxe3bq1mDtyAyg6QYQWWDL1qINj8ULik2ybI7Fd_gmPLvDXr6EnU6yRvYi1MGV6NfZaNPc1wI4wuyqkTh0nCyKGSTWQH6ERz87KW_uEAoHBlZ4CQvKr6BNaNqwYb3sZO8SRyVfdDrcp2A"><img loading="lazy" src="https://lh7-us.googleusercontent.com/Y1hgAmltswxe3bq1mDtyAyg6QYQWWDL1qINj8ULik2ybI7Fd_gmPLvDXr6EnU6yRvYi1MGV6NfZaNPc1wI4wuyqkTh0nCyKGSTWQH6ERz87KW_uEAoHBlZ4CQvKr6BNaNqwYb3sZO8SRyVfdDrcp2A" style="width:602px"/></a>
</figure>
<p class="" id="efc7e6e8-fd26-4f85-b752-f2d09d3cb3b4">Zoom InZoom Out 
                                                    ResetNew</p>
<p class="" id="befef3d3-9a8e-4e1e-9db6-8d0e22e6577d">ExistingMy
                                                    Notebook</p>
<p class="" id="d73ad6ab-96b1-42a1-b1ea-dfa17bcd39d8">Exhibit Display
                                                </p>
<figure class="image" id="309a189c-c361-4b0c-a543-21aaa6a1fd84"><a href="https://lh7-us.googleusercontent.com/5oZCpCuUsbZ-6-1ZIRMySc30CDOp4CHAjbt72fHL2O__iUqaLS-1tYt1l6CrogOZNL8g38XBRKizBbjP7eGUjlIYaHpEmhqv-4R9Ivlh0yUp7ekTPoFSgYv7S3bUjr5xxBr6PVZDXSPfwkg69QlOSA"><img loading="lazy" src="https://lh7-us.googleusercontent.com/5oZCpCuUsbZ-6-1ZIRMySc30CDOp4CHAjbt72fHL2O__iUqaLS-1tYt1l6CrogOZNL8g38XBRKizBbjP7eGUjlIYaHpEmhqv-4R9Ivlh0yUp7ekTPoFSgYv7S3bUjr5xxBr6PVZDXSPfwkg69QlOSA" style="width:602px"/></a>
</figure>
<p class="" id="f7f75ae1-8224-42f9-b89b-7e23f121e395">Zoom InZoom Out 
                                                    ResetNew</p>
<p class="" id="75498f48-1db4-4037-9ee7-b16e1a9f20b4">ExistingMy
                                                    Notebook</p>
<p class="" id="31090f75-e296-4a8a-af88-30633ed3814c">Exhibit Display
                                                </p>
<figure class="image" id="4701be6b-93ca-4be3-bb0f-b8041b699081"><a href="https://lh7-us.googleusercontent.com/Rf9i14m4tZcZwhKQG_waVAApOLRjEXLDTaGHDGQdZq9g7gnCmFO1cuKfPxvtBg497ADTHWWn4-Ez9al59HkB2XooaptIY5UYbo8E9SuoCIu3hGklOBHBxkrv5BfJd1iE8C9HccXSx52smb_uGdhUQQ"><img loading="lazy" src="https://lh7-us.googleusercontent.com/Rf9i14m4tZcZwhKQG_waVAApOLRjEXLDTaGHDGQdZq9g7gnCmFO1cuKfPxvtBg497ADTHWWn4-Ez9al59HkB2XooaptIY5UYbo8E9SuoCIu3hGklOBHBxkrv5BfJd1iE8C9HccXSx52smb_uGdhUQQ" style="width:602px"/></a>
</figure>
<p class="" id="c7ac7210-fbbc-427d-8007-e46a37144dac">Zoom InZoom Out 
                                                    ResetNew</p>
<p class="" id="455d2d75-c501-445b-8da8-b43d5615fc15">ExistingMy
                                                    Notebook</p>
<p class="" id="52d75282-57fd-4cdd-bb4f-07275d078ea2">Exhibit Display
                                                </p>
<figure class="image" id="70327884-2b73-4ca5-8718-3687726fc928"><a href="https://lh7-us.googleusercontent.com/Jaq_Ih0KABMbpjT9B81vCVo6btazI3lpAWm2zyHUubAEFiFtXsCRjX-42h_YkS3UGOjdP02y_S9yYqGrRRad68LeRN6LSOTElrQXgu9YDYfi817YqkWIIIVCOnRWQzCcfpWC7EHbr-VHv26jDNh_Sw"><img loading="lazy" src="https://lh7-us.googleusercontent.com/Jaq_Ih0KABMbpjT9B81vCVo6btazI3lpAWm2zyHUubAEFiFtXsCRjX-42h_YkS3UGOjdP02y_S9yYqGrRRad68LeRN6LSOTElrQXgu9YDYfi817YqkWIIIVCOnRWQzCcfpWC7EHbr-VHv26jDNh_Sw" style="width:602px"/></a>
</figure>
<p class="" id="01ac5099-6927-433a-be71-07f459286475">Zoom InZoom Out 
                                                    ResetNew</p>
<p class="" id="fb016036-c52d-4c89-8be5-aea49eb0c2cb">ExistingMy
                                                    Notebook</p>
<p class="" id="3253f9ee-d628-449b-b12d-2926443fee05">Exhibit Display
                                                </p>
<figure class="image" id="de307ee6-d35e-401c-b612-ba8480cf7395"><a href="https://lh7-us.googleusercontent.com/MrRVxKnogI-2neiyKNsleA79HXX60Wg4LZLPeuExEbKfqpjq957yS8CAeYElCMVNGw5nwuGu4kIGU_f1qdxDopdTmaUhR3qC5_27Gcc0UiT8Z39_cUOI4Cv6GlQw6KG1OT-ZRlm6wPq6eTHPL4wz-A"><img loading="lazy" src="https://lh7-us.googleusercontent.com/MrRVxKnogI-2neiyKNsleA79HXX60Wg4LZLPeuExEbKfqpjq957yS8CAeYElCMVNGw5nwuGu4kIGU_f1qdxDopdTmaUhR3qC5_27Gcc0UiT8Z39_cUOI4Cv6GlQw6KG1OT-ZRlm6wPq6eTHPL4wz-A" style="width:602px"/></a>
</figure>
<p class="" id="dba42676-35f9-4545-90f9-fe506c490e0b">Zoom InZoom Out 
                                                    ResetNew</p>
<p class="" id="52598910-4a28-4d73-a8e4-401d1e202136">ExistingMy
                                                    Notebook</p>
</details>
</li>
</ul>
</details>


















<style>
.bionic-reading-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    background: rgba(255, 255, 255, 0.2);
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 8px;
    color: white;
    font-size: 20px;
    cursor: pointer;
    transition: all 0.3s;
    margin-left: auto;
    flex-shrink: 0;
}

.bionic-reading-btn:hover {
    background: rgba(255, 255, 255, 0.35);
    border-color: rgba(255, 255, 255, 0.5);
    transform: scale(1.1);
}

.bionic-reading-btn.active {
    background: rgba(52, 168, 83, 0.4);
    border-color: rgba(52, 168, 83, 0.6);
}

.bionic-reading-btn.active:hover {
    background: rgba(52, 168, 83, 0.5);
}

summary {
    display: flex !important;
    align-items: center !important;
    gap: 12px !important;
}

    /* Highlighter styles */
    .highlighted {
        background-color: #ffeb3b !important;
        transition: background-color 0.2s ease !important;
    }

    .highlighter-btn {
        background: none !important;
        border: none !important;
        cursor: pointer !important;
        font-size: 20px !important;
        padding: 0 8px !important;
        margin-left: 8px !important;
        transition: transform 0.2s ease !important;
        vertical-align: middle !important;
    }

    .highlighter-btn:hover {
        transform: scale(1.2) !important;
    }

    .highlighter-btn.active {
        transform: scale(1.1) !important;
        filter: brightness(1.2) !important;
    }

    .highlighter-mode-active {
        cursor: text !important;
    }


    /* Right padding to avoid overlap with sidebar buttons */
    body {
        padding-right: 50px !important;
    }

    @media (max-width: 768px) {
        body {
            padding-right: 16px !important;
        }
    }


    


    

    /* Adjust table padding to make room for radio button */
    


    


    


    


    /* Clickable Answer Choices */
    table tr.answer-choice {
        cursor: pointer !important;
        transition: all 0.3s ease !important;
    }

    table tr.answer-choice:hover {
        background: #f8f9fa !important;
    }

    table tr.answer-choice td:first-child {
        position: relative !important;
        padding-left: 35px !important;
    }

    table tr.answer-choice td:first-child::before {
        content: '';
        position: absolute;
        left: 8px;
        top: 50%;
        transform: translateY(-50%);
        width: 16px;
        height: 16px;
        border: 2px solid #999;
        border-radius: 50%;
        background: white;
        transition: all 0.2s ease;
        box-sizing: border-box;
    }

    table tr.answer-choice.selected td:first-child::before {
        border-color: #1a73e8;
        border-width: 5px;
    }

    table tr.answer-choice.selected {
        background: #e8f4ff !important;
    }

    table tr.answer-choice.selected td:first-child {
        color: #1a73e8 !important;
        font-weight: 600 !important;
    }


    


    /* Answer Validation Styles */
    tr.answer-choice.answer-correct {
        background: linear-gradient(90deg, #d4edda 0%, #c3e6cb 100%) !important;
        border: 3px solid #28a745 !important;
        border-radius: 8px !important;
        box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3) !important;
    }

    tr.answer-choice.answer-correct td {
        color: #155724 !important;
        font-weight: 600 !important;
    }

    tr.answer-choice.answer-correct td:first-child::before {
        border-color: #28a745 !important;
        background: #28a745 !important;
        box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.2) !important;
    }

    tr.answer-choice.answer-incorrect {
        background: linear-gradient(90deg, #f8d7da 0%, #f5c6cb 100%) !important;
        border: 3px solid #dc3545 !important;
        border-radius: 8px !important;
        box-shadow: 0 2px 8px rgba(220, 53, 69, 0.3) !important;
    }

    tr.answer-choice.answer-incorrect td {
        color: #721c24 !important;
        font-weight: 600 !important;
    }

    tr.answer-choice.answer-incorrect td:first-child::before {
        border-color: #dc3545 !important;
        background: #dc3545 !important;
        box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.2) !important;
    }


    /* Answer Validation Styles */
    tr.answer-choice.answer-correct {
        background: linear-gradient(90deg, #d4edda 0%, #c3e6cb 100%) !important;
        border: 3px solid #28a745 !important;
        border-radius: 8px !important;
        box-shadow: 0 2px 8px rgba(40, 167, 69, 0.3) !important;
    }

    tr.answer-choice.answer-correct td {
        color: #155724 !important;
        font-weight: 600 !important;
    }

    tr.answer-choice.answer-correct td:first-child::before {
        border-color: #28a745 !important;
        background: #28a745 !important;
        box-shadow: 0 0 0 3px rgba(40, 167, 69, 0.2) !important;
    }

    tr.answer-choice.answer-incorrect {
        background: linear-gradient(90deg, #f8d7da 0%, #f5c6cb 100%) !important;
        border: 3px solid #dc3545 !important;
        border-radius: 8px !important;
        box-shadow: 0 2px 8px rgba(220, 53, 69, 0.3) !important;
    }

    tr.answer-choice.answer-incorrect td {
        color: #721c24 !important;
        font-weight: 600 !important;
    }

    tr.answer-choice.answer-incorrect td:first-child::before {
        border-color: #dc3545 !important;
        background: #dc3545 !important;
        box-shadow: 0 0 0 3px rgba(220, 53, 69, 0.2) !important;
    }

</style>



<script>
let bionicEnabled = false;
const originalContent = {};

function toggleBionicReading(event) {
    if (event) {
        event.preventDefault();
        event.stopPropagation();
    }

    bionicEnabled = !bionicEnabled;
    const btn = document.querySelector('.bionic-reading-btn');
    const icon = document.getElementById('bionicIcon');

    if (bionicEnabled) {
        btn.classList.add('active');
        icon.textContent = '‚úÖ';
        applyBionicReading();
    } else {
        btn.classList.remove('active');
        icon.textContent = 'üëÅÔ∏è';
        restoreOriginalText();
    }
}

function applyBionicReading() {
    // Seleciona todos os elementos de texto, EXCETO summary e buttons
    const textElements = document.querySelectorAll('p:not(summary p):not(button p), td:not(summary td):not(button td), li:not(summary li):not(button li)');

    textElements.forEach((element, index) => {
        // Ignora elementos que cont√™m outros elementos complexos
        if (element.querySelector('p, td, li, h1, h2, h3, h4, h5, h6, button, summary')) {
            return;
        }

        // Ignora se o elemento est√° dentro de um summary ou button
        if (element.closest('summary') || element.closest('button') || element.closest('.bionic-reading-btn')) {
            return;
        }

        // Salva o conte√∫do original
        if (!originalContent[index]) {
            originalContent[index] = {
                element: element,
                html: element.innerHTML
            };
        }

        // Aplica Bionic Reading
        const bionicText = convertToBionic(element.textContent);
        element.innerHTML = bionicText;
    });
}

function restoreOriginalText() {
    // Restaura o conte√∫do original
    Object.values(originalContent).forEach(item => {
        item.element.innerHTML = item.html;
    });
}

function convertToBionic(text) {
    // Divide o texto em palavras, mantendo pontua√ß√£o
    const words = text.split(/(\s+|[.,;:!?()""''\-‚Äì‚Äî])/);

    const bionicWords = words.map(word => {
        // Ignora espa√ßos e pontua√ß√£o
        if (word.match(/^\s+$/) || word.match(/^[.,;:!?()""''\-‚Äì‚Äî]+$/)) {
            return word;
        }

        // Ignora palavras muito curtas (1-2 letras)
        if (word.length <= 2) {
            return word;
        }

        // Determina quantas letras deixar em negrito (metade da palavra, arredondado para cima)
        const boldLength = Math.ceil(word.length / 2);

        // Separa a parte em negrito da parte normal
        const boldPart = word.substring(0, boldLength);
        const normalPart = word.substring(boldLength);

        // Retorna com a primeira parte em negrito
        return `<strong style="font-weight: 700 !important; color: inherit !important; background: none !important; padding: 0 !important;">${boldPart}</strong>${normalPart}`;
    });

    return bionicWords.join('');
}

// Adiciona atalho de teclado (Ctrl+B ou Cmd+B)
document.addEventListener('keydown', function(e) {
    if ((e.ctrlKey || e.metaKey) && e.key === 'b') {
        e.preventDefault();
        toggleBionicReading();
    }
});
</script>

<script>
    let highlighterActive = false;
    let questionHighlights = {};

    // Get question ID from the first summary strong tag
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Load highlights from localStorage
    function loadHighlights() {
        const questionId = getQuestionId();
        const stored = localStorage.getItem('highlights_' + questionId);
        if (stored) {
            questionHighlights = JSON.parse(stored);
            applyStoredHighlights();
        }
    }

    // Save highlights to localStorage
    function saveHighlights() {
        const questionId = getQuestionId();
        localStorage.setItem('highlights_' + questionId, JSON.stringify(questionHighlights));
    }

    // Apply stored highlights
    function applyStoredHighlights() {
        Object.keys(questionHighlights).forEach(key => {
            const element = document.querySelector(`[data-highlight-id="${key}"]`);
            if (element && questionHighlights[key]) {
                element.classList.add('highlighted');
            }
        });
    }

    // Toggle highlighter mode
    function toggleHighlighter(event) {
        event.stopPropagation();
        highlighterActive = !highlighterActive;

        const btn = event.target.closest('.highlighter-btn');
        const icon = btn.querySelector('#highlighterIcon');

        if (highlighterActive) {
            btn.classList.add('active');
            icon.textContent = 'üñçÔ∏è';
            document.body.classList.add('highlighter-mode-active');
        } else {
            btn.classList.remove('active');
            icon.textContent = 'üñäÔ∏è';
            document.body.classList.remove('highlighter-mode-active');
        }
    }

    // Clear all highlights for this question
    function clearHighlights() {
        const questionId = getQuestionId();
        questionHighlights = {};
        localStorage.removeItem('highlights_' + questionId);
        document.querySelectorAll('.highlighted').forEach(el => {
            el.classList.remove('highlighted');
        });
    }

    // Handle text selection and highlighting
    document.addEventListener('mouseup', function(e) {
        if (!highlighterActive) return;

        const selection = window.getSelection();
        if (!selection.toString().trim()) return;

        const range = selection.getRangeAt(0);
        const container = range.commonAncestorContainer;

        // Only highlight text in paragraphs, not in buttons or other elements
        const paragraph = container.nodeType === 3 ? container.parentElement : container;
        if (paragraph.tagName !== 'P' && paragraph.tagName !== 'LI' && paragraph.tagName !== 'TD') {
            return;
        }

        // Create highlight span
        const span = document.createElement('span');
        span.classList.add('highlighted');

        // Generate unique ID for this highlight
        const highlightId = 'hl-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
        span.setAttribute('data-highlight-id', highlightId);

        try {
            range.surroundContents(span);
            questionHighlights[highlightId] = true;
            saveHighlights();
        } catch (e) {
            console.log('Could not highlight selection');
        }

        selection.removeAllRanges();
    });

    // Load highlights when page loads
    window.addEventListener('load', loadHighlights);

    // Keyboard shortcut: Ctrl+H to toggle highlighter
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey && e.key === 'h') {
            e.preventDefault();
            const btn = document.querySelector('.highlighter-btn');
            if (btn) {
                toggleHighlighter({target: btn, stopPropagation: () => {}});
            }
        }
        // Ctrl+Shift+H to clear all highlights
        if (e.ctrlKey && e.shiftKey && e.key === 'H') {
            e.preventDefault();
            if (confirm('Clear all highlights for this question?')) {
                clearHighlights();
            }
        }
    });
</script>







<script>
(function() {
    // Get question ID from summary
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Find the correct answer by highest percentage
    function findCorrectAnswer() {
        // Find the Submit or Explanation details element
        const submitDetails = Array.from(document.querySelectorAll('details')).find(d => {
            const summary = d.querySelector('summary');
            return summary && (summary.textContent.includes('Submit') || summary.textContent.includes('Explanation'));
        });

        if (!submitDetails) return null;

        // Find all answer rows with percentages inside Submit section
        const table = submitDetails.querySelector('table.simple-table');
        if (!table) return null;

        const rows = table.querySelectorAll('tr');
        let maxPercentage = -1;
        let correctChoice = null;

        rows.forEach(row => {
            const firstCell = row.querySelector('td:first-child');
            const secondCell = row.querySelector('td:nth-child(2)');

            if (firstCell && secondCell) {
                const choiceMatch = firstCell.textContent.trim().match(/^([A-Z])\./);
                const percentMatch = secondCell.textContent.match(/(\d+)%/);

                if (choiceMatch && percentMatch) {
                    const choice = choiceMatch[1];
                    const percentage = parseInt(percentMatch[1]);

                    if (percentage > maxPercentage) {
                        maxPercentage = percentage;
                        correctChoice = choice;
                    }
                }
            }
        });

        return correctChoice;
    }

    // Check user's answer when Submit is opened
    function checkAnswer() {
        const questionId = getQuestionId();
        const choiceKey = 'choice_q' + questionId;
        const userChoice = localStorage.getItem(choiceKey);

        if (!userChoice) {
            console.log('No answer selected');
            return;
        }

        const correctAnswer = findCorrectAnswer();
        if (!correctAnswer) {
            console.log('Could not determine correct answer');
            return;
        }

        const isCorrect = userChoice === correctAnswer;

        // Save result to localStorage
        const resultKey = 'result_q' + questionId;
        const resultValue = isCorrect ? 'correct' : 'incorrect';
        localStorage.setItem(resultKey, resultValue);

        // Force storage event for parent window
        try {
            window.dispatchEvent(new StorageEvent('storage', {
                key: resultKey,
                newValue: resultValue,
                storageArea: localStorage
            }));
        } catch (e) {
            console.log('Could not dispatch storage event:', e);
        }

        // Visual feedback - highlight the selected answer row
        const selectedRow = document.querySelector(`tr.answer-choice[data-choice="${userChoice}"]`);
        if (selectedRow) {
            // Remove any existing validation classes
            document.querySelectorAll('tr.answer-choice').forEach(row => {
                row.classList.remove('answer-correct', 'answer-incorrect');
            });

            // Add appropriate class
            if (isCorrect) {
                selectedRow.classList.add('answer-correct');
            } else {
                selectedRow.classList.add('answer-incorrect');

                // Also highlight the correct answer
                const correctRow = document.querySelector(`tr.answer-choice[data-choice="${correctAnswer}"]`);
                if (correctRow) {
                    correctRow.classList.add('answer-correct');
                }
            }
        }

        // Notify parent window
        if (window.parent && window.parent !== window) {
            window.parent.postMessage({
                type: 'answerValidated',
                questionId: questionId,
                userChoice: userChoice,
                correctAnswer: correctAnswer,
                isCorrect: isCorrect
            }, '*');
        }

        console.log(`Answer checked: User=${userChoice}, Correct=${correctAnswer}, Result=${isCorrect ? 'Correct' : 'Incorrect'}`);
    }

    // Monitor Submit or Explanation details opening
    function setupSubmitMonitor() {
        const submitDetails = Array.from(document.querySelectorAll('details')).find(d => {
            const summary = d.querySelector('summary');
            return summary && (summary.textContent.includes('Submit') || summary.textContent.includes('Explanation'));
        });

        if (submitDetails) {
            submitDetails.addEventListener('toggle', function() {
                if (this.open) {
                    // Small delay to ensure everything is rendered
                    setTimeout(checkAnswer, 100);
                }
            });
        }
    }

    // Initialize when page loads
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', setupSubmitMonitor);
    } else {
        setupSubmitMonitor();
    }
})();
</script>

<script>
(function() {
    // Get question ID from summary
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Communicate with parent window (if in iframe)
    function notifyParent(choice) {
        if (window.parent && window.parent !== window) {
            window.parent.postMessage({
                type: 'choiceSelected',
                questionId: getQuestionId(),
                choice: choice
            }, '*');
        }
    }

    // Load saved choice from parent or localStorage
    function loadSavedChoice() {
        const questionId = getQuestionId();

        // Try to get from localStorage first
        const saved = localStorage.getItem('choice_q' + questionId);
        if (saved) {
            selectChoice(saved, false);
        }

        // Ask parent for saved choice (if in iframe)
        if (window.parent && window.parent !== window) {
            window.parent.postMessage({
                type: 'getChoice',
                questionId: questionId
            }, '*');
        }
    }

    // Listen for messages from parent
    window.addEventListener('message', function(event) {
        if (event.data.type === 'setChoice' && event.data.questionId === getQuestionId()) {
            selectChoice(event.data.choice, false);
        }
    });

    // Select a choice
    function selectChoice(choice, notify = true) {
        if (!choice) return;

        const questionId = getQuestionId();

        // Remove previous selection
        document.querySelectorAll('tr.answer-choice').forEach(row => {
            row.classList.remove('selected');
        });

        // Add selection to clicked choice
        const choiceRow = document.querySelector(`tr.answer-choice[data-choice="${choice}"]`);
        if (choiceRow) {
            choiceRow.classList.add('selected');

            // Save to localStorage
            localStorage.setItem('choice_q' + questionId, choice);

            // Notify parent (if in iframe)
            if (notify) {
                notifyParent(choice);
            }
        }
    }

    // Initialize answer choices
    function initializeChoices() {
        // Find all answer choice rows (A, B, C, D, E, F, etc.)
        const choicePattern = /^[A-Z]\.$/;
        const tables = document.querySelectorAll('table.simple-table');

        tables.forEach(table => {
            const rows = table.querySelectorAll('tr');
            rows.forEach(row => {
                const firstCell = row.querySelector('td:first-child');
                if (firstCell && choicePattern.test(firstCell.textContent.trim())) {
                    const choice = firstCell.textContent.trim().replace('.', '');
                    row.classList.add('answer-choice');
                    row.setAttribute('data-choice', choice);
                    row.style.position = 'relative';

                    // Add click handler
                    row.addEventListener('click', function(e) {
                        // Don't trigger if clicking inside a link or button
                        if (e.target.tagName === 'A' || e.target.closest('a')) return;

                        // Toggle selection
                        if (this.classList.contains('selected')) {
                            this.classList.remove('selected');
                            const questionId = getQuestionId();
                            localStorage.removeItem('choice_q' + questionId);
                            notifyParent('');
                        } else {
                            selectChoice(choice);
                        }
                    });
                }
            });
        });

        // Load saved choice after a short delay
        setTimeout(loadSavedChoice, 100);
    }

    // Run when page loads
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeChoices);
    } else {
        initializeChoices();
    }
})();
</script>

<script>
(function() {
    // Get question ID from summary
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Find the correct answer by highest percentage
    function findCorrectAnswer() {
        // Find the Submit or Explanation details element
        const submitDetails = Array.from(document.querySelectorAll('details')).find(d => {
            const summary = d.querySelector('summary');
            return summary && (summary.textContent.includes('Submit') || summary.textContent.includes('Explanation'));
        });

        if (!submitDetails) return null;

        // Find all answer rows with percentages inside Submit section
        const table = submitDetails.querySelector('table.simple-table');
        if (!table) return null;

        const rows = table.querySelectorAll('tr');
        let maxPercentage = -1;
        let correctChoice = null;

        rows.forEach(row => {
            const firstCell = row.querySelector('td:first-child');
            const secondCell = row.querySelector('td:nth-child(2)');

            if (firstCell && secondCell) {
                const choiceMatch = firstCell.textContent.trim().match(/^([A-Z])\./);
                const percentMatch = secondCell.textContent.match(/(\d+)%/);

                if (choiceMatch && percentMatch) {
                    const choice = choiceMatch[1];
                    const percentage = parseInt(percentMatch[1]);

                    if (percentage > maxPercentage) {
                        maxPercentage = percentage;
                        correctChoice = choice;
                    }
                }
            }
        });

        return correctChoice;
    }

    // Check user's answer when Submit is opened
    function checkAnswer() {
        const questionId = getQuestionId();
        const choiceKey = 'choice_q' + questionId;
        const userChoice = localStorage.getItem(choiceKey);

        if (!userChoice) {
            console.log('No answer selected');
            return;
        }

        const correctAnswer = findCorrectAnswer();
        if (!correctAnswer) {
            console.log('Could not determine correct answer');
            return;
        }

        const isCorrect = userChoice === correctAnswer;

        // Save result to localStorage
        const resultKey = 'result_q' + questionId;
        const resultValue = isCorrect ? 'correct' : 'incorrect';
        localStorage.setItem(resultKey, resultValue);

        // Force storage event for parent window
        try {
            window.dispatchEvent(new StorageEvent('storage', {
                key: resultKey,
                newValue: resultValue,
                storageArea: localStorage
            }));
        } catch (e) {
            console.log('Could not dispatch storage event:', e);
        }

        // Visual feedback - highlight the selected answer row
        const selectedRow = document.querySelector(`tr.answer-choice[data-choice="${userChoice}"]`);
        if (selectedRow) {
            // Remove any existing validation classes
            document.querySelectorAll('tr.answer-choice').forEach(row => {
                row.classList.remove('answer-correct', 'answer-incorrect');
            });

            // Add appropriate class
            if (isCorrect) {
                selectedRow.classList.add('answer-correct');
            } else {
                selectedRow.classList.add('answer-incorrect');

                // Also highlight the correct answer
                const correctRow = document.querySelector(`tr.answer-choice[data-choice="${correctAnswer}"]`);
                if (correctRow) {
                    correctRow.classList.add('answer-correct');
                }
            }
        }

        // Notify parent window
        if (window.parent && window.parent !== window) {
            window.parent.postMessage({
                type: 'answerValidated',
                questionId: questionId,
                userChoice: userChoice,
                correctAnswer: correctAnswer,
                isCorrect: isCorrect
            }, '*');
        }

        console.log(`Answer checked: User=${userChoice}, Correct=${correctAnswer}, Result=${isCorrect ? 'Correct' : 'Incorrect'}`);
    }

    // Monitor Submit or Explanation details opening
    function setupSubmitMonitor() {
        const submitDetails = Array.from(document.querySelectorAll('details')).find(d => {
            const summary = d.querySelector('summary');
            return summary && (summary.textContent.includes('Submit') || summary.textContent.includes('Explanation'));
        });

        if (submitDetails) {
            submitDetails.addEventListener('toggle', function() {
                if (this.open) {
                    // Small delay to ensure everything is rendered
                    setTimeout(checkAnswer, 100);
                }
            });
        }
    }

    // Initialize when page loads
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', setupSubmitMonitor);
    } else {
        setupSubmitMonitor();
    }
})();
</script>

<script>
(function() {
    // Get question ID from summary
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Find the correct answer by highest percentage
    function findCorrectAnswer() {
        // Find the Submit or Explanation details element
        const submitDetails = Array.from(document.querySelectorAll('details')).find(d => {
            const summary = d.querySelector('summary');
            return summary && (summary.textContent.includes('Submit') || summary.textContent.includes('Explanation'));
        });

        if (!submitDetails) return null;

        // Find all answer rows with percentages inside Submit section
        const table = submitDetails.querySelector('table.simple-table');
        if (!table) return null;

        const rows = table.querySelectorAll('tr');
        let maxPercentage = -1;
        let correctChoice = null;

        rows.forEach(row => {
            const firstCell = row.querySelector('td:first-child');
            const secondCell = row.querySelector('td:nth-child(2)');

            if (firstCell && secondCell) {
                const choiceMatch = firstCell.textContent.trim().match(/^([A-Z])\./);
                const percentMatch = secondCell.textContent.match(/(\d+)%/);

                if (choiceMatch && percentMatch) {
                    const choice = choiceMatch[1];
                    const percentage = parseInt(percentMatch[1]);

                    if (percentage > maxPercentage) {
                        maxPercentage = percentage;
                        correctChoice = choice;
                    }
                }
            }
        });

        return correctChoice;
    }

    // Check user's answer when Submit is opened
    function checkAnswer() {
        const questionId = getQuestionId();
        const choiceKey = 'choice_q' + questionId;
        const userChoice = localStorage.getItem(choiceKey);

        if (!userChoice) {
            console.log('No answer selected');
            return;
        }

        const correctAnswer = findCorrectAnswer();
        if (!correctAnswer) {
            console.log('Could not determine correct answer');
            return;
        }

        const isCorrect = userChoice === correctAnswer;

        // Save result to localStorage
        const resultKey = 'result_q' + questionId;
        const resultValue = isCorrect ? 'correct' : 'incorrect';
        localStorage.setItem(resultKey, resultValue);

        // Force storage event for parent window
        try {
            window.dispatchEvent(new StorageEvent('storage', {
                key: resultKey,
                newValue: resultValue,
                storageArea: localStorage
            }));
        } catch (e) {
            console.log('Could not dispatch storage event:', e);
        }

        // Visual feedback - highlight the selected answer row
        const selectedRow = document.querySelector(`tr.answer-choice[data-choice="${userChoice}"]`);
        if (selectedRow) {
            // Remove any existing validation classes
            document.querySelectorAll('tr.answer-choice').forEach(row => {
                row.classList.remove('answer-correct', 'answer-incorrect');
            });

            // Add appropriate class
            if (isCorrect) {
                selectedRow.classList.add('answer-correct');
            } else {
                selectedRow.classList.add('answer-incorrect');

                // Also highlight the correct answer
                const correctRow = document.querySelector(`tr.answer-choice[data-choice="${correctAnswer}"]`);
                if (correctRow) {
                    correctRow.classList.add('answer-correct');
                }
            }
        }

        // Notify parent window
        if (window.parent && window.parent !== window) {
            window.parent.postMessage({
                type: 'answerValidated',
                questionId: questionId,
                userChoice: userChoice,
                correctAnswer: correctAnswer,
                isCorrect: isCorrect
            }, '*');
        }

        console.log(`Answer checked: User=${userChoice}, Correct=${correctAnswer}, Result=${isCorrect ? 'Correct' : 'Incorrect'}`);
    }

    // Monitor Submit or Explanation details opening
    function setupSubmitMonitor() {
        const submitDetails = Array.from(document.querySelectorAll('details')).find(d => {
            const summary = d.querySelector('summary');
            return summary && (summary.textContent.includes('Submit') || summary.textContent.includes('Explanation'));
        });

        if (submitDetails) {
            submitDetails.addEventListener('toggle', function() {
                if (this.open) {
                    // Small delay to ensure everything is rendered
                    setTimeout(checkAnswer, 100);
                }
            });
        }
    }

    // Initialize when page loads
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', setupSubmitMonitor);
    } else {
        setupSubmitMonitor();
    }
})();
</script>

<script>
(function() {
    // Get question ID from summary
    function getQuestionId() {
        const firstSummary = document.querySelector('summary strong');
        return firstSummary ? firstSummary.textContent.trim() : '1';
    }

    // Find the correct answer by highest percentage
    function findCorrectAnswer() {
        // Find the Submit or Explanation details element
        const submitDetails = Array.from(document.querySelectorAll('details')).find(d => {
            const summary = d.querySelector('summary');
            return summary && (summary.textContent.includes('Submit') || summary.textContent.includes('Explanation'));
        });

        if (!submitDetails) return null;

        // Find all answer rows with percentages inside Submit section
        const table = submitDetails.querySelector('table.simple-table');
        if (!table) return null;

        const rows = table.querySelectorAll('tr');
        let maxPercentage = -1;
        let correctChoice = null;

        rows.forEach(row => {
            const firstCell = row.querySelector('td:first-child');
            const secondCell = row.querySelector('td:nth-child(2)');

            if (firstCell && secondCell) {
                const choiceMatch = firstCell.textContent.trim().match(/^([A-Z])\./);
                const percentMatch = secondCell.textContent.match(/(\d+)%/);

                if (choiceMatch && percentMatch) {
                    const choice = choiceMatch[1];
                    const percentage = parseInt(percentMatch[1]);

                    if (percentage > maxPercentage) {
                        maxPercentage = percentage;
                        correctChoice = choice;
                    }
                }
            }
        });

        return correctChoice;
    }

    // Check user's answer when Submit is opened
    function checkAnswer() {
        const questionId = getQuestionId();
        const choiceKey = 'choice_q' + questionId;
        const userChoice = localStorage.getItem(choiceKey);

        if (!userChoice) {
            console.log('No answer selected');
            return;
        }

        const correctAnswer = findCorrectAnswer();
        if (!correctAnswer) {
            console.log('Could not determine correct answer');
            return;
        }

        const isCorrect = userChoice === correctAnswer;

        // Save result to localStorage
        const resultKey = 'result_q' + questionId;
        const resultValue = isCorrect ? 'correct' : 'incorrect';
        localStorage.setItem(resultKey, resultValue);

        // Force storage event for parent window
        try {
            window.dispatchEvent(new StorageEvent('storage', {
                key: resultKey,
                newValue: resultValue,
                storageArea: localStorage
            }));
        } catch (e) {
            console.log('Could not dispatch storage event:', e);
        }

        // Visual feedback - highlight the selected answer row
        const selectedRow = document.querySelector(`tr.answer-choice[data-choice="${userChoice}"]`);
        if (selectedRow) {
            // Remove any existing validation classes
            document.querySelectorAll('tr.answer-choice').forEach(row => {
                row.classList.remove('answer-correct', 'answer-incorrect');
            });

            // Add appropriate class
            if (isCorrect) {
                selectedRow.classList.add('answer-correct');
            } else {
                selectedRow.classList.add('answer-incorrect');

                // Also highlight the correct answer
                const correctRow = document.querySelector(`tr.answer-choice[data-choice="${correctAnswer}"]`);
                if (correctRow) {
                    correctRow.classList.add('answer-correct');
                }
            }
        }

        // Notify parent window
        if (window.parent && window.parent !== window) {
            window.parent.postMessage({
                type: 'answerValidated',
                questionId: questionId,
                userChoice: userChoice,
                correctAnswer: correctAnswer,
                isCorrect: isCorrect
            }, '*');
        }

        console.log(`Answer checked: User=${userChoice}, Correct=${correctAnswer}, Result=${isCorrect ? 'Correct' : 'Incorrect'}`);
    }

    // Monitor Submit or Explanation details opening
    function setupSubmitMonitor() {
        const submitDetails = Array.from(document.querySelectorAll('details')).find(d => {
            const summary = d.querySelector('summary');
            return summary && (summary.textContent.includes('Submit') || summary.textContent.includes('Explanation'));
        });

        if (submitDetails) {
            submitDetails.addEventListener('toggle', function() {
                if (this.open) {
                    // Small delay to ensure everything is rendered
                    setTimeout(checkAnswer, 100);

                    // Notify parent that Submit/Explanation was opened
                    if (window.parent && window.parent !== window) {
                        window.parent.postMessage({
                            type: 'submitOpened',
                            questionId: getQuestionId()
                        }, '*');
                    }
                } else {
                    // Notify parent that Submit/Explanation was closed
                    if (window.parent && window.parent !== window) {
                        window.parent.postMessage({
                            type: 'submitClosed',
                            questionId: getQuestionId()
                        }, '*');
                    }
                }
            });
        }
    }

    // Initialize when page loads
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', setupSubmitMonitor);
    } else {
        setupSubmitMonitor();
    }
})();
</script>
